!function(e){function t(t){for(var r,a,s=t[0],c=t[1],u=t[2],f=0,p=[];f<s.length;f++)a=s[f],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&p.push(i[a][0]),i[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(t);p.length;)p.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(r=!1)}r&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},i={0:0},o=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;o.push([667,1]),n()}({1755:function(e,t,n){},1756:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(n,Phaser.Renderer.WebGL.Pipelines.TextureTintPipeline);var t=s(n);function n(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this,{game:e,renderer:e.renderer,fragShader:"\n            precision mediump float;\n\n            uniform float time;\n            uniform sampler2D uMainSampler;\n            varying vec2 outTexCoord;\n\n            void main(void) {\n                vec4 color = texture2D(uMainSampler, outTexCoord);\n                if (color.a != 0.0) {\n                    gl_FragColor = mix(color, vec4(1.0), cos(time / 50.0));\n                }\n            }"})}return n}();function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g(e);if(t){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v(this,n)}}function v(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O="../assets",w={SPRITESHEET:"".concat(O,"/spritesheets"),IMAGES:"".concat(O,"/images"),TILESETS:"".concat(O,"/tilesets"),TILEMAPS:"".concat(O,"/tilemaps"),SOUNDS:"".concat(O,"/sounds")},S={frameWidth:32,frameHeight:32},P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(o,e);var t,n,r,i=b(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"Boot")}return t=o,(n=[{key:"preload",value:function(){var e=this.cameras.main.width,t=this.cameras.main.height,n=this.add.graphics(),r=this.add.graphics();r.fillStyle(3094089,.8),r.fillRect(e/2-160-10,t/2-30,320,50),this.make.text({x:e/2,y:t/2-50,text:"Loading...",style:{font:"20px monospace",fill:"#ffffff"}}).setOrigin(.5,.5);var i=this.make.text({x:e/2,y:t/2-5,text:"0%",style:{font:"18px monospace",fill:"#ffffff"}});i.setOrigin(.5,.5),this.load.on("progress",(function(r){n.clear(),n.fillStyle(16777215,1),n.fillRect(e/2-160,t/2-20,300*r,30),i.setText(parseInt(String(100*r),10)+"%")})),this.load.spritesheet("player","".concat(w.SPRITESHEET,"/player.png"),h(h({},S),{},{margin:1,spacing:2})),this.load.spritesheet("player_flash","".concat(w.SPRITESHEET,"/player_flash.png"),{frameWidth:48,frameHeight:32}),this.load.spritesheet("gun_bullet","".concat(w.SPRITESHEET,"/gun_bullet.png"),{frameWidth:10,frameHeight:10}),this.load.spritesheet("sphere","".concat(w.SPRITESHEET,"/sphere.png"),S),this.load.spritesheet("gun","".concat(w.SPRITESHEET,"/gun.png"),S),this.load.spritesheet("button","".concat(w.SPRITESHEET,"/button.png"),S),this.load.spritesheet("lever","".concat(w.SPRITESHEET,"/lever.png"),S),this.load.spritesheet("tube_switcher","".concat(w.SPRITESHEET,"/tube_switcher.png"),S),this.load.spritesheet("hiding_platform","".concat(w.SPRITESHEET,"/hiding_platform.png"),S),this.load.spritesheet("reflector","".concat(w.SPRITESHEET,"/reflector.png"),S),this.load.spritesheet("glorg","".concat(w.SPRITESHEET,"/glorg.png"),S),this.load.spritesheet("charger","".concat(w.SPRITESHEET,"/charger.png"),S),this.load.spritesheet("robot1","".concat(w.SPRITESHEET,"/robot1.png"),S),this.load.spritesheet("bat","".concat(w.SPRITESHEET,"/bat.png"),{frameWidth:16,frameHeight:16}),this.load.spritesheet("steam_small","".concat(w.SPRITESHEET,"/steam_small.png"),S),this.load.spritesheet("steam_big","".concat(w.SPRITESHEET,"/steam_big.png"),{frameWidth:128,frameHeight:64}),this.load.spritesheet("button_music","".concat(w.SPRITESHEET,"/button_music.png"),S),this.load.spritesheet("button_sfx","".concat(w.SPRITESHEET,"/button_sfx.png"),S),this.load.spritesheet("button_level","".concat(w.SPRITESHEET,"/button_level.png"),S),this.load.spritesheet("button_left","".concat(w.SPRITESHEET,"/button_left.png"),{frameWidth:64,frameHeight:64}),this.load.spritesheet("button_right","".concat(w.SPRITESHEET,"/button_right.png"),{frameWidth:64,frameHeight:64}),this.load.spritesheet("button_up","".concat(w.SPRITESHEET,"/button_up.png"),{frameWidth:64,frameHeight:64}),this.load.spritesheet("button_hit","".concat(w.SPRITESHEET,"/button_hit.png"),{frameWidth:64,frameHeight:64}),this.load.spritesheet("track","".concat(w.SPRITESHEET,"/track.png"),{frameWidth:128,frameHeight:32}),this.load.image("spike","".concat(w.IMAGES,"/spike.png")),this.load.image("jumper_opened","".concat(w.IMAGES,"/jumper_opened.png")),this.load.image("tiles","".concat(w.TILESETS,"/industrial.png")),this.load.tilemapTiledJSON("mapL1","".concat(w.TILEMAPS,"/warehouse_v2_L1.json")),this.load.tilemapTiledJSON("mapL2","".concat(w.TILEMAPS,"/warehouse_v2_L2.json")),this.load.tilemapTiledJSON("mapL3","".concat(w.TILEMAPS,"/warehouse_v2_L3.json")),this.load.tilemapTiledJSON("mapL4","".concat(w.TILEMAPS,"/warehouse_v2_L4.json")),this.load.tilemapTiledJSON("mapL5","".concat(w.TILEMAPS,"/warehouse_v2_L5.json")),this.load.audio("bg_1",["".concat(w.SOUNDS,"/background/bg_1.ogg"),"".concat(w.SOUNDS,"/background/bg_1.mp3")]),this.load.audio("die",["".concat(w.SOUNDS,"/player/die.ogg"),"".concat(w.SOUNDS,"/player/die.mp3")]),this.load.audio("jump",["".concat(w.SOUNDS,"/player/jump.ogg"),"".concat(w.SOUNDS,"/player/jump.mp3")]),this.load.audio("jump1",["".concat(w.SOUNDS,"/player/jump1.ogg"),"".concat(w.SOUNDS,"/player/jump1.mp3")]),this.load.audio("jump2",["".concat(w.SOUNDS,"/player/jump2.ogg"),"".concat(w.SOUNDS,"/player/jump2.mp3")]),this.load.audio("jump3",["".concat(w.SOUNDS,"/player/jump3.ogg"),"".concat(w.SOUNDS,"/player/jump3.mp3")]),this.load.audio("jump4",["".concat(w.SOUNDS,"/player/jump4.ogg"),"".concat(w.SOUNDS,"/player/jump4.mp3")]),this.load.audio("jump5",["".concat(w.SOUNDS,"/player/jump5.ogg"),"".concat(w.SOUNDS,"/player/jump5.mp3")]),this.load.audio("jump6",["".concat(w.SOUNDS,"/player/jump6.ogg"),"".concat(w.SOUNDS,"/player/jump6.mp3")]),this.load.audio("jump7",["".concat(w.SOUNDS,"/player/jump7.ogg"),"".concat(w.SOUNDS,"/player/jump7.mp3")]),this.load.audio("jump8",["".concat(w.SOUNDS,"/player/jump8.ogg"),"".concat(w.SOUNDS,"/player/jump8.mp3")]),this.load.audio("land",["".concat(w.SOUNDS,"/player/land.ogg"),"".concat(w.SOUNDS,"/player/land.mp3")]),this.load.audio("hit",["".concat(w.SOUNDS,"/player/hit.ogg"),"".concat(w.SOUNDS,"/player/hit.mp3")]),this.load.audio("step",["".concat(w.SOUNDS,"/player/step.ogg"),"".concat(w.SOUNDS,"/player/step.mp3")]),this.load.audio("sphere",["".concat(w.SOUNDS,"/environment/sphere.ogg"),"".concat(w.SOUNDS,"/environment/sphere.mp3")]),this.load.audio("gun",["".concat(w.SOUNDS,"/environment/gun.ogg"),"".concat(w.SOUNDS,"/environment/gun.mp3")]),this.load.audio("lever",["".concat(w.SOUNDS,"/environment/lever.ogg"),"".concat(w.SOUNDS,"/environment/lever.mp3")]),this.load.audio("jumper",["".concat(w.SOUNDS,"/environment/jumper.ogg"),"".concat(w.SOUNDS,"/environment/jumper.mp3")]),this.load.audio("reflector",["".concat(w.SOUNDS,"/environment/reflector.ogg"),"".concat(w.SOUNDS,"/environment/reflector.mp3")]),this.load.audio("reflector_collide",["".concat(w.SOUNDS,"/environment/reflector_collide.ogg"),"".concat(w.SOUNDS,"/environment/reflector_collide.mp3")]),this.load.audio("steam_big",["".concat(w.SOUNDS,"/environment/steam_big.ogg"),"".concat(w.SOUNDS,"/environment/steam_big.mp3")]),this.load.audio("steam_small",["".concat(w.SOUNDS,"/environment/steam_small.ogg"),"".concat(w.SOUNDS,"/environment/steam_small.mp3")])}},{key:"addPipelines",value:function(){this.game.renderer.addPipeline("blink",new l(this.game))}},{key:"create",value:function(){this.addPipelines(),this.scene.start("L1")}}])&&d(t.prototype,n),r&&d(t,r),o}(i.a.Scene);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=D(e);if(t){var i=D(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return T(this,n)}}function T(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?E(e):t}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R,M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(o,e);var t,n,r,i=x(o);function o(e){var t,n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),t=i.call(this,e.scene,e.x,e.y,e.text,{fontSize:18,fontFamily:"monospace",color:"#000000",padding:{x:20,y:10},backgroundColor:"#ffffff"}),n=E(t),a=void 0,(r="props")in n?Object.defineProperty(n,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[r]=a,t.props=e,t.init(),t}return t=o,(n=[{key:"init",value:function(){this.x=-this.width,this.setScrollFactor(0).setAlpha(0).setDepth(11),this.scene.add.existing(this)}},{key:"setValue",value:function(e){this.text=e,this.x=-this.width,this.setAlpha(0)}},{key:"show",value:function(e){this.scene.tweens.add({targets:this,alpha:1,x:this.props.x,ease:"Back.easeOut",duration:400,onComplete:function(){return null==e?void 0:e()}})}},{key:"hide",value:function(e){this.scene.tweens.add({targets:this,alpha:0,x:-this.width,ease:"Back.easeIn",duration:400,onComplete:function(){return null==e?void 0:e()}})}}])&&k(t.prototype,n),r&&k(t,r),o}(i.a.GameObjects.Text);function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I="step",A="jump",N="land",L="hit",z="die",G="jumper",H="gun",B="reflector",F="reflector_collide",U="lever",V="sphere",X="steam_big",W="steam_small",J=(C(R={bg_1:.2},I,.5),C(R,A,.5),C(R,N,.4),C(R,L,.3),C(R,z,.5),C(R,G,.4),C(R,H,.4),C(R,B,.5),C(R,F,.5),C(R,U,.4),C(R,V,.5),C(R,X,.3),C(R,W,.5),R);function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ee(e);if(t){var i=ee(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Q(this,n)}}function Q(e,t){return!t||"object"!==Y(t)&&"function"!=typeof t?Z(e):t}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(a,e);var t,n,r,o=q(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),te(Z(t=o.call(this,e.scene,e.x,e.y,"button_".concat(e.type),0)),"props",void 0),te(Z(t),"pressed",!1),t.props=e,t.init(),t}return t=a,(n=[{key:"init",value:function(){this.setScrollFactor(0).setInteractive().setAlpha(.25).on(i.a.Input.Events.POINTER_DOWN,this.switchOn).on(i.a.Input.Events.POINTER_OVER,this.switchOn).on(i.a.Input.Events.POINTER_UP,this.switchOff).on(i.a.Input.Events.POINTER_OUT,this.switchOff),this.scene.add.existing(this)}},{key:"switchOn",value:function(){var e,t;this.pressed||(this.setFrame(1),this.setAlpha(.5),this.pressed=!0,null===(e=(t=this.props).onSwitchOn)||void 0===e||e.call(t))}},{key:"switchOff",value:function(){var e,t;this.pressed&&(this.setFrame(0),this.setAlpha(.25),this.pressed=!1,null===(e=(t=this.props).onSwitchOff)||void 0===e||e.call(t))}}])&&K(t.prototype,n),r&&K(t,r),a}(i.a.GameObjects.Sprite);function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var oe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ie(this,"scene",void 0),ie(this,"soundManager",void 0),ie(this,"sprite",void 0),ie(this,"flash",void 0),ie(this,"keys",null),ie(this,"gamepad",null),ie(this,"leftBtn",null),ie(this,"rightBtn",null),ie(this,"upBtn",null),ie(this,"hitBtn",null),ie(this,"lastHitTime",Date.now()),ie(this,"deltaHorAcceleration",0),this.scene=t.scene,this.soundManager=t.soundManager,this.createAnimations(),this.createControls(),this.createSprite(t.x,t.y)}var t,n,r;return t=e,(n=[{key:"createAnimations",value:function(){var e=this.scene.anims;e.create({key:"player-idle",frames:e.generateFrameNumbers("player",{start:0,end:3}),frameRate:4,repeat:-1}),e.create({key:"player-run",frames:e.generateFrameNumbers("player",{start:8,end:15}),frameRate:12,repeat:-1}),e.create({key:"player-land",frames:e.generateFrameNumbers("player",{start:4,end:7}),frameRate:12}),e.create({key:"player-hit",frames:e.generateFrameNumbers("player",{start:24,end:27}),frameRate:14}),e.create({key:"player-flash",frames:e.generateFrameNumbers("player_flash",{start:0,end:3}),frameRate:14,hideOnComplete:!0})}},{key:"createControls",value:function(){var e=this;if(this.scene.sys.game.device.input.touch)this.scene.input.addPointer(4),this.leftBtn=new ne({scene:this.scene,x:48,y:this.scene.cameras.main.height-48,type:"left"}),this.rightBtn=new ne({scene:this.scene,x:118,y:this.scene.cameras.main.height-48,type:"right"}),this.hitBtn=new ne({scene:this.scene,x:this.scene.cameras.main.width-48,y:this.scene.cameras.main.height-48,type:"hit"}),this.upBtn=new ne({scene:this.scene,x:this.scene.cameras.main.width-48,y:this.scene.cameras.main.height-122,type:"up"});else{var t=i.a.Input.Keyboard.KeyCodes,n=t.SPACE,r=t.LEFT,o=t.RIGHT,a=t.UP,s=t.W,c=t.A,u=t.D;this.keys=this.scene.input.keyboard.addKeys({space:n,left:r,right:o,up:a,w:s,a:c,d:u})}this.scene.input.gamepad.once("down",(function(t){e.gamepad=t}))}},{key:"createSprite",value:function(e,t){this.sprite=this.scene.physics.add.sprite(e,t,"player",0).setDrag(2e3,0).setMaxVelocity(200,1e3).setSize(18,24).setOffset(7,9).setDepth(2)}},{key:"createFlash",value:function(){var e=this;this.flash=this.scene.add.sprite(this.sprite.x,this.sprite.y,"player_flash",0).setFlipX(this.sprite.flipX).play("player-flash",!0).on(i.a.Animations.Events.SPRITE_ANIMATION_COMPLETE,(function(){e.flash.destroy()})),this.flash.x+=this.sprite.flipX?-this.flash.width/2-this.sprite.width/2:this.flash.width/2+this.sprite.width/2,this.scene.physics.add.existing(this.flash),this.flash.body.enable=!1,this.flash.body.setMaxVelocity(0,0).setSize(48,32),setTimeout((function(){e.flash.body.enable=!0}),0)}},{key:"hit",value:function(){var e,t;(null===(e=this.flash)||void 0===e||null===(t=e.anims)||void 0===t?void 0:t.isPlaying)||(this.createFlash(),this.soundManager.hit())}},{key:"freeze",value:function(){this.sprite.body.moves=!1}},{key:"update",value:function(){var e,t,n,r,i,o,a,s,c,u,l=this.keys,f=this.sprite,p=Date.now(),h=f.body.blocked.down,y=h?400:300,d=(null==l?void 0:l.left.isDown)||(null==l?void 0:l.a.isDown)||(null===(e=this.leftBtn)||void 0===e?void 0:e.pressed)||(null===(t=this.gamepad)||void 0===t?void 0:t.left),m=(null==l?void 0:l.right.isDown)||(null==l?void 0:l.d.isDown)||(null===(n=this.rightBtn)||void 0===n?void 0:n.pressed)||(null===(r=this.gamepad)||void 0===r?void 0:r.right),b=(null==l?void 0:l.up.isDown)||(null==l?void 0:l.w.isDown)||(null===(i=this.upBtn)||void 0===i?void 0:i.pressed)||(null===(o=this.gamepad)||void 0===o?void 0:o.A),v=(null==l?void 0:l.space.isDown)||(null===(a=this.hitBtn)||void 0===a?void 0:a.pressed)||(null===(s=this.gamepad)||void 0===s?void 0:s.X);d?(f.body.velocity.x>0&&f.setVelocityX(0),f.setAccelerationX(-y+this.deltaHorAcceleration),f.setFlipX(!0),h&&!f.body.blocked.left&&this.soundManager.step()):m?(f.body.velocity.x<0&&f.setVelocityX(0),f.setAccelerationX(y+this.deltaHorAcceleration),f.setFlipX(!1),h&&!f.body.blocked.right&&this.soundManager.step()):f.setAccelerationX(this.deltaHorAcceleration),this.deltaHorAcceleration&&(f.body.acceleration.x+=this.deltaHorAcceleration),h&&b&&(this.soundManager.jump(),f.setVelocityY(-400)),v&&p-this.lastHitTime>=500&&(f.anims.play("player-hit",!0),this.lastHitTime=p,this.hit()),f.anims.isPlaying&&"player-hit"===(null===(c=f.anims.currentAnim)||void 0===c?void 0:c.key)||(f.body.deltaY()>.3&&h&&(f.anims.play("player-land",!0),this.soundManager.land()),f.anims.isPlaying&&"player-land"===(null===(u=f.anims.currentAnim)||void 0===u?void 0:u.key)||(h&&0===f.body.velocity.x?f.anims.play("player-idle",!0):h?f.anims.play("player-run",!0):(f.anims.stop(),f.setTexture("player",10))))}},{key:"destroy",value:function(){var e,t,n,r;null===(e=this.gamepad)||void 0===e||null===(t=e.pad)||void 0===t||null===(n=t.vibrationActuator)||void 0===n||null===(r=n.playEffect)||void 0===r||r.call(n,"dual-rumble",{duration:300,strongMagnitude:1,weakMagnitude:.5}),this.sprite.destroy()}}])&&re(t.prototype,n),r&&re(t,r),e}();function ae(e){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ce(e,t){return(ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe(e);if(t){var i=pe(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return le(this,n)}}function le(e,t){return!t||"object"!==ae(t)&&"function"!=typeof t?fe(e):t}function fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var he=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ce(e,t)}(o,e);var t,n,r,i=ue(o);function o(e){var t,n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),t=i.call(this,e.scene,e.x,e.y,"sphere",6),n=fe(t),a=void 0,(r="props")in n?Object.defineProperty(n,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[r]=a,t.props=e,t.init(),t}return t=o,(n=[{key:"init",value:function(){this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0)}},{key:"activate",value:function(){this.props.onEnter()}}])&&se(t.prototype,n),r&&se(t,r),o}(i.a.GameObjects.Sprite);function ye(e){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function me(e,t){return(me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Oe(e);if(t){var i=Oe(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ve(this,n)}}function ve(e,t){return!t||"object"!==ye(t)&&"function"!=typeof t?ge(e):t}function ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oe(e){return(Oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function we(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(o,e);var t,n,r,i=be(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),we(ge(t=i.call(this,e.scene,e.x,e.y,"lever",0)),"props",void 0),we(ge(t),"lastSwitchTime",Date.now()),we(ge(t),"switchedOn",!1),t.props=e,t.init(),t}return t=o,(n=[{key:"init",value:function(){this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0),this.body.setSize(24,20),this.body.setOffset(6,12)}},{key:"blink",value:function(){var e=this;this.setPipeline("blink"),setTimeout((function(){return e.resetPipeline()}),50)}},{key:"checkSwitchAccessibility",value:function(){var e=Date.now();return!(e-this.lastSwitchTime<500||(this.lastSwitchTime=e,0))}},{key:"switchOn",value:function(){this.setFrame(4),this.props.onSwitchOn(),this.switchedOn=!0}},{key:"switchOff",value:function(){var e,t;this.setFrame(0),null===(e=(t=this.props).onSwitchOff)||void 0===e||e.call(t),this.switchedOn=!1}},{key:"switch",value:function(){this.checkSwitchAccessibility()&&(this.switchedOn?this.switchOff():this.switchOn(),this.blink(),this.props.soundManager.lever())}}])&&de(t.prototype,n),r&&de(t,r),o}(i.a.GameObjects.Sprite);function Pe(e){return(Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ke(e,t){return(ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var i=Ee(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return xe(this,n)}}function xe(e,t){return!t||"object"!==Pe(t)&&"function"!=typeof t?Te(e):t}function Te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function De(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ke(e,t)}(a,e);var t,n,r,o=_e(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),De(Te(t=o.call(this,e.scene,e.x,e.y,"hiding_platform",3)),"props",void 0),De(Te(t),"lastSwitchTime",Date.now()),De(Te(t),"shown",void 0),t.props=e,t.createAnimations(),t.init(),t}return t=a,(n=[{key:"createAnimations",value:function(){this.scene.anims.create({key:"platform-hide",frames:this.scene.anims.generateFrameNumbers("hiding_platform",{start:0,end:3}),frameRate:12}),this.scene.anims.create({key:"platform-show",frames:this.scene.anims.generateFrameNumbers("hiding_platform",{start:3,end:0}),frameRate:12})}},{key:"init",value:function(){var e=this.props.initialVisibility,t=void 0!==e&&e;this.shown=t,this.scene.add.existing(this)}},{key:"switch",value:function(){var e=this,t=Date.now();if(this.scene&&!(t-this.lastSwitchTime<500)){var n=this.shown?"platform-hide":"platform-show";this.lastSwitchTime=t,this.shown=!this.shown,this.shown||this.props.tilemap.removeTileAtWorldXY(this.x,this.y),this.play(n),this.on(i.a.Animations.Events.SPRITE_ANIMATION_COMPLETE,(function(){e.shown&&e.props.tilemap.putTileAtWorldXY(353,e.x,e.y).setCollision(!0)}))}}}])&&je(t.prototype,n),r&&je(t,r),a}(i.a.GameObjects.Sprite);function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ie=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ce(this,"scene",void 0),Ce(this,"manager",void 0),Ce(this,"bgKey","bg_1"),Ce(this,"volumeConfig",void 0),Ce(this,"lastStepTime",Date.now()),Ce(this,"bgMusicMuted",void 0),Ce(this,"sfxMuted",void 0),this.scene=t.scene,this.manager=t.scene.sound,this.volumeConfig=t.volumeConfig,this.bgMusicMuted=0===this.volumeConfig[this.bgKey],this.sfxMuted=0===this.volumeConfig[A]}var t,n,r;return t=e,(n=[{key:"playBGMusic",value:function(){var e=this.manager.get(this.bgKey);e?e.play():this.manager.play(this.bgKey,{volume:.2,loop:!0})}},{key:"muteBGMusic",value:function(){this.manager.get(this.bgKey).volume=0,this.volumeConfig[this.bgKey]=0,this.bgMusicMuted=!0}},{key:"unmuteBGMusic",value:function(){var e=this.manager.get(this.bgKey);e.volume=J[this.bgKey],this.volumeConfig[this.bgKey]=J[this.bgKey],this.bgMusicMuted=!1,e.isPlaying||e.play()}},{key:"stopBGMusic",value:function(){this.manager.stopByKey(this.bgKey)}},{key:"isBGMusicPlaying",value:function(){var e=this.manager.get(this.bgKey);return null==e?void 0:e.isPlaying}},{key:"step",value:function(){var e,t=I,n=Date.now();(null===(e=this.manager.get(I))||void 0===e?void 0:e.isPlaying)||n-this.lastStepTime<300||(this.lastStepTime=n,this.manager.play(t,{volume:this.volumeConfig[t]}))}},{key:"jump",value:function(){var e=i.a.Math.Between(1,8),t=A;this.manager.play("jump".concat(e),{volume:this.volumeConfig[t]})}},{key:"land",value:function(){var e=N;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"hit",value:function(){var e=L;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"die",value:function(){var e=z;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"jumper",value:function(){var e=G;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"gun",value:function(){var e=H;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"reflector",value:function(){var e=B;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"reflectorCollide",value:function(){var e=F;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"lever",value:function(){var e=U;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"steamSmall",value:function(e,t){var n=W;this.scene.cameras.main.worldView.contains(e,t)&&this.manager.play(n,{volume:this.volumeConfig[n]})}},{key:"steamBig",value:function(e,t){var n=X;this.scene.cameras.main.worldView.contains(e,t)&&this.manager.play(n,{volume:this.volumeConfig[n]})}},{key:"sphere",value:function(){var e=V;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"muteSFX",value:function(){var e=this;Object.keys(this.volumeConfig).forEach((function(t){t!==e.bgKey&&(e.volumeConfig[t]=0)})),this.sfxMuted=!0}},{key:"unmuteSFX",value:function(){var e=this;Object.keys(this.volumeConfig).forEach((function(t){t!==e.bgKey&&(e.volumeConfig[t]=J[t])})),this.sfxMuted=!1}}])&&Me(t.prototype,n),r&&Me(t,r),e}();function Ae(e){return(Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Le(e,t){return(Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Be(e);if(t){var i=Be(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ge(this,n)}}function Ge(e,t){return!t||"object"!==Ae(t)&&"function"!=typeof t?He(e):t}function He(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Be(e){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Le(e,t)}(a,e);var t,n,r,o=ze(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Fe(He(t=o.call(this,e.scene,e.x,e.y,e.texture,0)),"props",void 0),Fe(He(t),"switchedOn",void 0),Fe(He(t),"lastSwitchTime",Date.now()),t.props=e,t.init(),t}return t=a,(n=[{key:"init",value:function(){var e=this.props.switchedOn,t=void 0===e||e;this.switchedOn=t,this.switchedOn||this.setFrame(1),this.scene.add.existing(this),this.setScrollFactor(0),this.setInteractive(),this.on(i.a.Input.Events.POINTER_DOWN,this.switch)}},{key:"switchOn",value:function(){this.setFrame(0),this.props.onSwitchOn(),this.switchedOn=!0}},{key:"switchOff",value:function(){var e,t;this.setFrame(1),null===(e=(t=this.props).onSwitchOff)||void 0===e||e.call(t),this.switchedOn=!1}},{key:"switch",value:function(){this.switchedOn?this.switchOff():this.switchOn()}}])&&Ne(t.prototype,n),r&&Ne(t,r),a}(i.a.GameObjects.Sprite);function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Je(e,t,n){return t&&We(e.prototype,t),n&&We(e,n),e}function Ye(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ke(e,t)}function Ke(e,t){return(Ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze(e);if(t){var i=Ze(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return qe(this,n)}}function qe(e,t){return!t||"object"!==Ve(t)&&"function"!=typeof t?Qe(e):t}function Qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ze(e){return(Ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function et(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tt=function(e){Ye(n,e);var t=$e(n);function n(e){var r;Xe(this,n),et(Qe(r=t.call(this,e.scene,e.camera.midPoint.x,e.camera.midPoint.y)),"props",void 0),r.props=e;var o=e.camera,a=o.width,s=o.height,c=e.scene.add.rectangle(0,0,a,s,0,.5);return r.setDepth(20),c.setInteractive(),r.add(c),r.createButtons(),e.scene.add.existing(Qe(r)),c.on(i.a.Input.Events.POINTER_DOWN,(function(){r.destroy()})),r}return Je(n,[{key:"createButtons",value:function(){var e=this,t=rt(this.scene),n=-(40*t.length+10*(t.length-1))/2;t.forEach((function(t){var r=e.scene.add.text(n,0,t,{fontSize:18,fontFamily:"monospace",color:"#000000",padding:{x:10,y:6},backgroundColor:"#ffffff"}).setOrigin(.5,.5).setInteractive().on(i.a.Input.Events.POINTER_DOWN,(function(){e.scene.scene.start(t);var n=e.props.soundManager.volumeConfig;e.scene.scene.start(t,{volumeConfig:n})}));e.add(r),n+=50}))}}]),n}(i.a.GameObjects.Container),nt=function(e){Ye(n,e);var t=$e(n);function n(e){var r;return Xe(this,n),et(Qe(r=t.call(this,e.scene,e.x,e.y,"button_level",0)),"props",void 0),r.props=e,r.init(),r}return Je(n,[{key:"init",value:function(){var e=this;this.setScrollFactor(0).setInteractive().on(i.a.Input.Events.POINTER_DOWN,(function(){var t,n;null===(t=(n=e.props).onClick)||void 0===t||t.call(n),new tt({scene:e.props.scene,camera:e.scene.cameras.main,soundManager:e.props.soundManager})})),this.scene.add.existing(this)}}]),n}(i.a.GameObjects.Sprite),rt=function(e){return e.scene.manager.scenes.map((function(e){return e.sys.config})).slice(1)},it=function(e,t){var n=t.bgMusicMuted,r=t.sfxMuted;new Ue({scene:e,texture:"button_music",x:e.cameras.main.width-32,y:32,switchedOn:!n,onSwitchOn:function(){t.unmuteBGMusic()},onSwitchOff:function(){t.muteBGMusic()}}),new Ue({scene:e,texture:"button_sfx",x:e.cameras.main.width-32,y:74,switchedOn:!r,onSwitchOn:function(){t.unmuteSFX()},onSwitchOff:function(){t.muteSFX()}}),new nt({scene:e,x:e.cameras.main.width-32,y:116,soundManager:t})};function ot(e){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function st(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(Object(n),!0).forEach((function(t){yt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ut(e,t){return(ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ht(e);if(t){var i=ht(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ft(this,n)}}function ft(e,t){return!t||"object"!==ot(t)&&"function"!=typeof t?pt(e):t}function pt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ht(e){return(ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ut(e,t)}(o,e);var t,n,r,i=lt(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),yt(pt(e=i.call(this,"L1")),"player",void 0),yt(pt(e),"soundManager",void 0),yt(pt(e),"isPlayerDisabled",void 0),yt(pt(e),"tilemap",void 0),yt(pt(e),"obstacles",void 0),yt(pt(e),"sphere",void 0),yt(pt(e),"platform",void 0),yt(pt(e),"lever",void 0),yt(pt(e),"nextLevel",(function(){e.isPlayerDisabled=!0;var t=e.cameras.main;t.zoomTo(2,1e3),e.player.freeze(),e.soundManager.stopBGMusic(),e.soundManager.sphere(),t.once("camerazoomcomplete",(function(){t.fade(1e3,29,33,45)})),t.once("camerafadeoutcomplete",(function(){var t=e.soundManager.volumeConfig;e.player.destroy(),e.scene.start("L2",{volumeConfig:t})}))})),e}return t=o,(n=[{key:"create",value:function(e){var t=this,n=e.volumeConfig,r=this.sys.game.device.input.touch;this.soundManager=new Ie({scene:this,volumeConfig:n||st({},J)}),this.isPlayerDisabled=!1,this.tilemap=this.make.tilemap({key:"mapL1"});var i=this.tilemap.addTilesetImage("industrial.v2","tiles");this.tilemap.createDynamicLayer("background",i),this.obstacles=this.tilemap.createDynamicLayer("obstacles",i),this.tilemap.createDynamicLayer("foreground",i).setDepth(10),it(this,this.soundManager),this.createPlayer(),this.createHidingPlatform(),this.createLever(),this.createSphere(),this.obstacles.setCollisionByProperty({collides:!0}),this.physics.world.addCollider(this.player.sprite,this.obstacles),this.cameras.main.startFollow(this.player.sprite,!0,.1,.1),this.cameras.main.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels),this.soundManager.isBGMusicPlaying()||this.soundManager.playBGMusic(),r?setTimeout((function(){t.scale.startFullscreen()}),1e3):this.time.addEvent({delay:1e3,callback:function(){return t.createHelpToast()}})}},{key:"getPoint",value:function(e,t){return this.tilemap.findObject(e,(function(e){return e.name===t}))}},{key:"createHelpToast",value:function(){new M({scene:this,x:16,y:16,text:"Arrow keys or WASD to move & jump\nSpace to hit"}).show()}},{key:"createPlayer",value:function(){var e=this.getPoint("points","spawn"),t=e.x,n=e.y;this.player=new oe({scene:this,x:t,y:n,soundManager:this.soundManager})}},{key:"createHidingPlatform",value:function(){var e=this.getPoint("points","platform"),t=e.x,n=e.y;this.platform=new Re({scene:this,x:t,y:n,tilemap:this.obstacles})}},{key:"createLever",value:function(){var e=this,t=this.getPoint("points","lever"),n=t.x,r=t.y;this.lever=new Se({scene:this,x:n,y:r,soundManager:this.soundManager,onSwitchOn:function(){e.platform.switch()},onSwitchOff:function(){e.platform.switch()}})}},{key:"createSphere",value:function(){var e=this.getPoint("points","sphere"),t=e.x,n=e.y;this.sphere=new he({scene:this,x:t,y:n,onEnter:this.nextLevel})}},{key:"checkLeversOverlap",value:function(){this.physics.world.overlap(this.lever,this.player.flash,(function(e){e.switch()}))}},{key:"checkSphereOverlap",value:function(){this.physics.world.overlap(this.sphere,this.player.sprite,(function(e){e.activate()}))}},{key:"checkGameOver",value:function(){return this.player.sprite.y>this.obstacles.height}},{key:"restart",value:function(){var e=this;this.isPlayerDisabled=!0;var t=this.cameras.main;t.shake(100,.05),t.fade(250,0,0,0),this.player.freeze(),this.soundManager.die(),t.once("camerafadeoutcomplete",(function(){var t=e.soundManager.volumeConfig;e.player.destroy(),e.scene.restart({volumeConfig:t})}))}},{key:"update",value:function(){this.isPlayerDisabled||(this.player.update(),this.checkLeversOverlap(),this.checkSphereOverlap(),this.checkGameOver()&&this.restart())}}])&&ct(t.prototype,n),r&&ct(t,r),o}(i.a.Scene);function mt(e){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vt(e,t){return(vt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=St(e);if(t){var i=St(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ot(this,n)}}function Ot(e,t){return!t||"object"!==mt(t)&&"function"!=typeof t?wt(e):t}function wt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function St(e){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vt(e,t)}(o,e);var t,n,r,i=gt(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Pt(wt(t=i.call(this,e.scene,e.x,e.y,"jumper_opened")),"props",void 0),Pt(wt(t),"id",void 0),Pt(wt(t),"lastSwitchTime",Date.now()),Pt(wt(t),"opened",!1),Pt(wt(t),"toggleView",(function(){t.opened?(t.props.tile.visible=!1,t.visible=!0):(t.props.tile.visible=!0,t.visible=!1)})),t.props=e,t.id=e.id,t.init(),t}return t=o,(n=[{key:"init",value:function(){this.visible=!1,this.y-=16,this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0),this.body.setSize(28,2),this.body.setOffset(2,31),this.scene.add.existing(this)}},{key:"switch",value:function(){var e=this,t=Date.now();t-this.lastSwitchTime<500||(this.opened=!this.opened,this.lastSwitchTime=t,this.toggleView(),setTimeout((function(){e.opened=!e.opened,e.toggleView()}),500),this.props.soundManager.jumper())}}])&&bt(t.prototype,n),r&&bt(t,r),o}(i.a.GameObjects.Sprite);function kt(e){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Et(e,t)}function Et(e,t){return(Et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ct(e);if(t){var i=Ct(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Rt(this,n)}}function Rt(e,t){return!t||"object"!==kt(t)&&"function"!=typeof t?Mt(e):t}function Mt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ct(e){return(Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function It(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var At=function(e){Tt(n,e);var t=Dt(n);function n(e,r,i,o){var a;return xt(this,n),It(Mt(a=t.call(this,e,i,o,"gun_bullet",0)),"dir",void 0),a.dir=r,a.scene.add.existing(Mt(a)),a.scene.physics.add.existing(Mt(a)),a.body.setAllowGravity(!1),a.body.setVelocityX(500),a}return n}(i.a.GameObjects.Sprite),Nt=function(e){Tt(o,e);var t,n,r,i=Dt(o);function o(e){var t;return xt(this,o),It(Mt(t=i.call(this,e.scene,e.x,e.y,"gun",0)),"props",void 0),It(Mt(t),"lastShootTime",Date.now()),It(Mt(t),"opened",!1),t.props=e,t.createAnimation(),t.init(),t.play("gun-idle"),t}return t=o,(n=[{key:"createAnimation",value:function(){this.scene.anims.create({key:"gun-idle",frames:this.scene.anims.generateFrameNumbers("gun",{start:0,end:2}),frameRate:4,repeat:-1})}},{key:"init",value:function(){this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0)}},{key:"shoot",value:function(){var e=this,t=Date.now();if(!(t-this.lastShootTime<500)){var n=new At(this.scene,this.props.dir,this.x,this.y);this.props.group.add(n),this.setPipeline("blink"),setTimeout((function(){return e.resetPipeline()}),50),this.lastShootTime=t,this.props.soundManager.gun()}}}])&&_t(t.prototype,n),r&&_t(t,r),o}(i.a.GameObjects.Sprite);function Lt(e){return(Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gt(e,t){return(Gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ht(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ut(e);if(t){var i=Ut(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Bt(this,n)}}function Bt(e,t){return!t||"object"!==Lt(t)&&"function"!=typeof t?Ft(e):t}function Ft(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ut(e){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gt(e,t)}(o,e);var t,n,r,i=Ht(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Vt(Ft(t=i.call(this,e.scene,e.x,e.y,"reflector",0)),"props",void 0),Vt(Ft(t),"lastSwitchTime",Date.now()),Vt(Ft(t),"lastCollisionTime",Date.now()),Vt(Ft(t),"opened",!1),t.props=e,t.init(),t}return t=o,(n=[{key:"init",value:function(){this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0)}},{key:"collide",value:function(){var e=this;this.setFrame(1),setTimeout((function(){e.setFrame(0)}),100),this.props.soundManager.reflectorCollide()}},{key:"switch",value:function(){var e,t,n=this,r=Date.now();if(!(r-this.lastSwitchTime<500)){null===(e=(t=this.props).onSwitch)||void 0===e||e.call(t);var i=360===this.angle?0:this.angle+90;this.scene.tweens.add({targets:this,angle:i,ease:"Linear",duration:200}),this.setPipeline("blink"),setTimeout((function(){return n.resetPipeline()}),50),this.lastSwitchTime=r,this.props.soundManager.reflector()}}}])&&zt(t.prototype,n),r&&zt(t,r),o}(i.a.GameObjects.Sprite);function Wt(e){return(Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(n),!0).forEach((function(t){tn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $t(e,t){return($t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=en(e);if(t){var i=en(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Qt(this,n)}}function Qt(e,t){return!t||"object"!==Wt(t)&&"function"!=typeof t?Zt(e):t}function Zt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function en(e){return(en=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$t(e,t)}(o,e);var t,n,r,i=qt(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),tn(Zt(e=i.call(this,"L2")),"player",void 0),tn(Zt(e),"soundManager",void 0),tn(Zt(e),"isPlayerDisabled",void 0),tn(Zt(e),"tilemap",void 0),tn(Zt(e),"obstacles",void 0),tn(Zt(e),"spikes",void 0),tn(Zt(e),"bullets",void 0),tn(Zt(e),"reflectors",void 0),tn(Zt(e),"sphere",void 0),tn(Zt(e),"jumper",void 0),tn(Zt(e),"lever",void 0),tn(Zt(e),"gun",void 0),tn(Zt(e),"nextLevel",(function(){e.isPlayerDisabled=!0;var t=e.cameras.main;t.zoomTo(2,1e3),e.player.freeze(),e.soundManager.stopBGMusic(),e.soundManager.sphere(),t.once("camerazoomcomplete",(function(){t.fade(1e3,29,33,45)})),t.once("camerafadeoutcomplete",(function(){var t=e.soundManager.volumeConfig;e.player.destroy(),e.scene.start("L3",{volumeConfig:t})}))})),e}return t=o,(n=[{key:"create",value:function(e){var t=this,n=e.volumeConfig;this.soundManager=new Ie({scene:this,volumeConfig:n||Yt({},J)}),this.isPlayerDisabled=!1,this.tilemap=this.make.tilemap({key:"mapL2"});var r=this.tilemap.addTilesetImage("industrial.v2","tiles");this.tilemap.createDynamicLayer("background",r),this.obstacles=this.tilemap.createDynamicLayer("obstacles",r),this.tilemap.createDynamicLayer("foreground",r).setDepth(10),it(this,this.soundManager),this.createSpikes(),this.createPlayer(),this.createGun(),this.createReflectors(),this.createLever(),this.createJumper(),this.createSphere(),this.obstacles.setCollisionByProperty({collides:!0}),this.physics.world.addCollider(this.player.sprite,this.obstacles),this.physics.world.addCollider(this.bullets,this.obstacles,(function(e){e.destroy()})),this.cameras.main.startFollow(this.player.sprite,!0,.1,.1),this.cameras.main.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels),this.soundManager.isBGMusicPlaying()||this.soundManager.playBGMusic(),this.sys.game.device.input.touch&&setTimeout((function(){t.scale.startFullscreen()}),1e3)}},{key:"getPoint",value:function(e,t){return this.tilemap.findObject(e,(function(e){return e.name===t}))}},{key:"getPoints",value:function(e,t){var n=this;return t.map((function(t){return n.getPoint(e,t)}))}},{key:"createSpikes",value:function(){var e=this;this.spikes=this.physics.add.staticGroup(),this.obstacles.forEachTile((function(t){if(77===t.index){var n=e.spikes.create(t.getCenterX(),t.getCenterY(),"spike");n.rotation=t.rotation,0===n.angle?n.body.setSize(32,6).setOffset(0,26):-90===n.angle?n.body.setSize(6,32).setOffset(26,0):90===n.angle?n.body.setSize(6,32).setOffset(0,0):-180===n.angle&&n.body.setSize(32,6).setOffset(0,0),e.obstacles.removeTileAt(t.x,t.y)}}))}},{key:"createPlayer",value:function(){var e=this.getPoint("points","spawn"),t=e.x,n=e.y;this.player=new oe({scene:this,x:t,y:n,soundManager:this.soundManager})}},{key:"createGun",value:function(){this.bullets=this.add.group();var e=this.getPoint("points","gun"),t=e.x,n=e.y;this.gun=new Nt({scene:this,x:t,y:n,group:this.bullets,dir:"right",soundManager:this.soundManager})}},{key:"createReflectors",value:function(){var e=this;this.reflectors=this.physics.add.group({allowGravity:!1}),this.getPoints("points",["reflector_top","reflector_bottom"]).forEach((function(t){var n=t.x,r=t.y;return e.reflectors.add(new Xt({scene:e,x:n,y:r,soundManager:e.soundManager}))}))}},{key:"createLever",value:function(){var e=this,t=this.getPoint("points","lever"),n=t.x,r=t.y,i=this.getPoint("points","removable");this.lever=new Se({scene:this,x:n,y:r,soundManager:this.soundManager,onSwitchOn:function(){e.obstacles.removeTileAtWorldXY(i.x,i.y)},onSwitchOff:function(){e.obstacles.putTileAtWorldXY(14,i.x,i.y).setCollision(!0)}})}},{key:"createJumper",value:function(){var e=this.getPoint("points","jumper"),t=e.x,n=e.y;this.jumper=new jt({scene:this,x:t,y:n,tile:this.obstacles.getTileAtWorldXY(t,n),soundManager:this.soundManager})}},{key:"createSphere",value:function(){var e=this.getPoint("points","sphere"),t=e.x,n=e.y;this.sphere=new he({scene:this,x:t,y:n,onEnter:this.nextLevel})}},{key:"checkGunOverlap",value:function(){this.physics.world.overlap(this.gun,this.player.flash,(function(e){e.shoot()}))}},{key:"checkReflectorsOverlap",value:function(){this.physics.world.overlap(this.reflectors,this.player.flash,(function(e,t){t.switch()}))}},{key:"checkBulletReflectorOverlap",value:function(){this.physics.world.overlap(this.bullets,this.reflectors,(function(e,t){var n=Date.now(),r=e,i=t;if(!(n<i.lastCollisionTime+100)){var o=i.angle;switch(r.dir){case"right":if(![-90,-180].includes(o)){e.destroy();break}r.dir=-180===o?"down":"up",r.x=i.x-r.width/2,r.body.setVelocity(0,-180===o?500:-500),i.collide();break;case"left":if(![0,90].includes(o)){r.destroy();break}r.dir=90===o?"down":"up",r.x=i.x+r.width/2,r.body.setVelocity(0,90===o?500:-500),i.collide();break;case"up":if(![90,-180].includes(o)){r.destroy();break}r.dir=-180===o?"left":"right",r.x=i.x,r.y=i.y+r.height/2,r.body.setVelocity(-180===o?-500:500,0),i.collide();break;case"down":if(![0,-90].includes(o)){r.destroy();break}r.dir=-90===o?"left":"right",r.x=i.x,r.y=i.y-r.height/2,r.body.setVelocity(-90===o?-500:500,0),i.collide();break;default:r.destroy()}i.lastCollisionTime=n}}))}},{key:"checkLeversOverlap",value:function(){this.physics.world.overlap(this.lever,this.bullets,(function(e){e.switch()}))}},{key:"checkJumpersOverlap",value:function(){this.physics.world.overlap(this.jumper,this.player.sprite,(function(e,t){e.switch(),t.setVelocityY(-1e3)}))}},{key:"checkSphereOverlap",value:function(){this.physics.world.overlap(this.sphere,this.player.sprite,(function(e){e.activate()}))}},{key:"checkGameOver",value:function(){return this.physics.world.overlap(this.player.sprite,this.spikes)}},{key:"restart",value:function(){var e=this;this.isPlayerDisabled=!0;var t=this.cameras.main;t.shake(100,.05),t.fade(250,0,0,0),this.player.freeze(),this.soundManager.die(),t.once("camerafadeoutcomplete",(function(){e.player.destroy(),e.scene.restart()}))}},{key:"update",value:function(){this.isPlayerDisabled||(this.player.update(),this.checkGunOverlap(),this.checkReflectorsOverlap(),this.checkBulletReflectorOverlap(),this.checkLeversOverlap(),this.checkJumpersOverlap(),this.checkSphereOverlap(),this.checkGameOver()&&this.restart())}}])&&Kt(t.prototype,n),r&&Kt(t,r),o}(i.a.Scene);function rn(e){return(rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function on(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function an(e,t){return(an=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ln(e);if(t){var i=ln(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return cn(this,n)}}function cn(e,t){return!t||"object"!==rn(t)&&"function"!=typeof t?un(e):t}function un(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ln(e){return(ln=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&an(e,t)}(o,e);var t,n,r,i=sn(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),fn(un(t=i.call(this,e.scene,e.x,e.y,"bat",0)),"props",void 0),fn(un(t),"hazardType","common"),t.props=e,t.createAnimations(),t.init(),t}return t=o,(n=[{key:"createAnimations",value:function(){var e=this.scene.anims;e.create({key:"bat-fly",frames:e.generateFrameNumbers("bat",{start:0,end:4}),frameRate:8,repeat:-1})}},{key:"init",value:function(){this.setScale(1.5),this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0),this.play("bat-fly")}},{key:"follow",value:function(){var e=this,t=this.props,n=t.start,r=t.end,i=t.followDuration,o=void 0===i?2e3:i,a=r.x<n.x;this.setFlipX(a),this.scene.tweens.add({targets:this,x:r.x,y:r.y,ease:"Sine",duration:o,onComplete:function(){e.setFlipX(!a),e.scene.tweens.add({targets:e,x:n.x,y:n.y,ease:"Sine",duration:o,onComplete:function(){e.follow()}})}})}},{key:"die",value:function(){this.anims.stop(),this.body.setMaxVelocity(0,1e3),this.body.setVelocityY(300)}}])&&on(t.prototype,n),r&&on(t,r),o}(i.a.GameObjects.Sprite);function hn(e){return(hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return dn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mn(Object(n),!0).forEach((function(t){jn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gn(e,t){return(gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function On(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pn(e);if(t){var i=Pn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return wn(this,n)}}function wn(e,t){return!t||"object"!==hn(t)&&"function"!=typeof t?Sn(e):t}function Sn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pn(e){return(Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var kn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gn(e,t)}(o,e);var t,n,r,i=On(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),jn(Sn(e=i.call(this,"L3")),"timer",void 0),jn(Sn(e),"soundManager",void 0),jn(Sn(e),"player",void 0),jn(Sn(e),"isPlayerDisabled",void 0),jn(Sn(e),"tilemap",void 0),jn(Sn(e),"obstacles",void 0),jn(Sn(e),"spikes",void 0),jn(Sn(e),"jumpers",void 0),jn(Sn(e),"hazards",void 0),jn(Sn(e),"platforms",void 0),jn(Sn(e),"sphere",void 0),jn(Sn(e),"jumper",void 0),jn(Sn(e),"lever",void 0),jn(Sn(e),"nextLevel",(function(){e.isPlayerDisabled=!0;var t=e.cameras.main;t.zoomTo(2,1e3),e.player.freeze(),e.timer.remove(),e.soundManager.stopBGMusic(),e.soundManager.sphere(),t.once("camerazoomcomplete",(function(){t.fade(1e3,29,33,45)})),t.once("camerafadeoutcomplete",(function(){var t=e.soundManager.volumeConfig;e.player.destroy(),e.scene.start("L4",{volumeConfig:t})}))})),e}return t=o,(n=[{key:"create",value:function(e){var t=this,n=e.volumeConfig;this.soundManager=new Ie({scene:this,volumeConfig:n||bn({},J)}),this.isPlayerDisabled=!1,this.tilemap=this.make.tilemap({key:"mapL3"});var r=this.tilemap.addTilesetImage("industrial.v2","tiles");this.tilemap.createDynamicLayer("background",r),this.obstacles=this.tilemap.createDynamicLayer("obstacles",r),this.tilemap.createDynamicLayer("foreground",r).setDepth(10),it(this,this.soundManager),this.createSpikes(),this.createPlayer(),this.createHidingPlatform(),this.createJumpers(),this.createHazards(),this.createSphere(),this.obstacles.setCollisionByProperty({collides:!0}),this.physics.world.addCollider(this.player.sprite,this.obstacles),this.cameras.main.startFollow(this.player.sprite,!0,.1,.1),this.cameras.main.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels),setTimeout((function(){t.timer=t.time.addEvent({delay:3e3,callback:function(){t.platforms.forEach((function(e,t){setTimeout((function(){null==e||e.switch()}),100*t)}))},callbackScope:t,loop:!0})}),100),this.soundManager.isBGMusicPlaying()||this.soundManager.playBGMusic(),this.sys.game.device.input.touch&&setTimeout((function(){t.scale.startFullscreen()}),1e3)}},{key:"getPoint",value:function(e,t){return this.tilemap.findObject(e,(function(e){return e.name===t}))}},{key:"getPoints",value:function(e,t){var n=this;return t.map((function(t){return n.getPoint(e,t)}))}},{key:"createSpikes",value:function(){var e=this;this.spikes=this.physics.add.staticGroup(),this.obstacles.forEachTile((function(t){if(77===t.index){var n=e.spikes.create(t.getCenterX(),t.getCenterY(),"spike");n.rotation=t.rotation,0===n.angle?n.body.setSize(32,6).setOffset(0,26):-90===n.angle?n.body.setSize(6,32).setOffset(26,0):90===n.angle?n.body.setSize(6,32).setOffset(0,0):-180===n.angle&&n.body.setSize(32,6).setOffset(0,0),e.obstacles.removeTileAt(t.x,t.y)}}))}},{key:"createPlayer",value:function(){var e=this.getPoint("points","spawn"),t=e.x,n=e.y;this.player=new oe({scene:this,x:t,y:n,soundManager:this.soundManager})}},{key:"createHidingPlatform",value:function(){var e=this;this.platforms=[],this.getPoints("platforms",["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"]).forEach((function(t){var n=t.x,r=t.y,i=new Re({scene:e,x:n,y:r,tilemap:e.obstacles});e.platforms.push(i)}))}},{key:"createJumpers",value:function(){var e=this;this.jumpers=this.physics.add.group({allowGravity:!1}),this.getPoints("points",["jumper1","jumper2","jumper3","jumper4"]).forEach((function(t,n){var r=t.x,i=t.y,o=new jt({scene:e,x:r,y:i,tile:e.obstacles.getTileAtWorldXY(r,i),id:"jumper_".concat(n+1),soundManager:e.soundManager});e.jumpers.add(o)}))}},{key:"createHazards",value:function(){this.hazards=this.physics.add.group({allowGravity:!1});var e=yn(this.getPoints("points",["h1_start","h1_end"]),2),t=e[0],n=e[1],r=new pn({scene:this,x:t.x,y:t.y,start:t,end:n});r.follow(),this.hazards.add(r);var i=yn(this.getPoints("points",["h2_start","h2_end"]),2),o=i[0],a=i[1],s=new pn({scene:this,x:o.x,y:o.y,start:o,end:a});s.follow(),this.hazards.add(s)}},{key:"createSphere",value:function(){var e=this.getPoint("points","sphere"),t=e.x,n=e.y;this.sphere=new he({scene:this,x:t,y:n,onEnter:this.nextLevel})}},{key:"checkJumpersOverlap",value:function(){this.physics.world.overlap(this.jumpers,this.player.sprite,(function(e,t){var n=t,r=e;switch(n.switch(),r.setVelocityY(-650),n.id){case"jumper_1":n.switch(),r.setVelocityY(-650);break;default:n.switch(),r.setVelocityY(-550)}}))}},{key:"checkSphereOverlap",value:function(){this.physics.world.overlap(this.sphere,this.player.sprite,(function(e){e.activate()}))}},{key:"checkGameOver",value:function(){return this.physics.world.overlap(this.player.sprite,this.spikes)||this.physics.world.overlap(this.player.sprite,this.hazards)}},{key:"restart",value:function(){var e=this;this.isPlayerDisabled=!0;var t=this.cameras.main;t.shake(100,.05),t.fade(250,0,0,0),this.player.freeze(),this.timer.remove(),this.soundManager.die(),t.once("camerafadeoutcomplete",(function(){e.player.destroy(),e.scene.restart()}))}},{key:"update",value:function(){this.isPlayerDisabled||(this.player.update(),this.checkJumpersOverlap(),this.checkSphereOverlap(),this.checkGameOver()&&this.restart())}}])&&vn(t.prototype,n),r&&vn(t,r),o}(i.a.Scene);function _n(e){return(_n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tn(e,t){return(Tn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function En(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Mn(e);if(t){var i=Mn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Dn(this,n)}}function Dn(e,t){return!t||"object"!==_n(t)&&"function"!=typeof t?Rn(e):t}function Rn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mn(e){return(Mn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var In=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tn(e,t)}(o,e);var t,n,r,i=En(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Cn(Rn(t=i.call(this,e.scene,e.x,e.y,"track",0)),"props",void 0),Cn(Rn(t),"power",void 0),t.props=e,t.createAnimations(),t.init(),t}return t=o,(n=[{key:"createAnimations",value:function(){this.scene.anims.create({key:"track-left",frames:this.scene.anims.generateFrameNumbers("track",{start:2,end:0}),frameRate:12,repeat:-1}),this.scene.anims.create({key:"track-right",frames:this.scene.anims.generateFrameNumbers("track",{start:0,end:2}),frameRate:12,repeat:-1})}},{key:"init",value:function(){var e=this.props,t=e.dir,n=void 0===t?"left":t,r=e.power;this.props.power?this.power=r:this.power="left"===n?-150:150,this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0),this.body.setSize(128,2),this.body.setOffset(0,-1),this.scene.add.existing(this),"left"===n?this.play("track-left"):this.play("track-right")}}])&&xn(t.prototype,n),r&&xn(t,r),o}(i.a.GameObjects.Sprite);function An(e){return(An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ln(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nn(Object(n),!0).forEach((function(t){Vn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gn(e,t){return(Gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Un(e);if(t){var i=Un(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Bn(this,n)}}function Bn(e,t){return!t||"object"!==An(t)&&"function"!=typeof t?Fn(e):t}function Fn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Un(e){return(Un=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gn(e,t)}(o,e);var t,n,r,i=Hn(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Vn(Fn(e=i.call(this,"L4")),"timer",void 0),Vn(Fn(e),"soundManager",void 0),Vn(Fn(e),"player",void 0),Vn(Fn(e),"isPlayerDisabled",void 0),Vn(Fn(e),"tilemap",void 0),Vn(Fn(e),"obstacles",void 0),Vn(Fn(e),"spikes",void 0),Vn(Fn(e),"jumpers",void 0),Vn(Fn(e),"tracks",void 0),Vn(Fn(e),"hazards",void 0),Vn(Fn(e),"platforms",void 0),Vn(Fn(e),"sphere",void 0),Vn(Fn(e),"jumper",void 0),Vn(Fn(e),"lever",void 0),Vn(Fn(e),"nextLevel",(function(){e.isPlayerDisabled=!0;var t=e.cameras.main;t.zoomTo(2,1e3),e.player.freeze(),e.soundManager.stopBGMusic(),e.soundManager.sphere(),t.once("camerazoomcomplete",(function(){t.fade(1e3,29,33,45)})),t.once("camerafadeoutcomplete",(function(){var t=e.soundManager.volumeConfig;e.player.destroy(),e.scene.start("L5",{volumeConfig:t})}))})),e}return t=o,(n=[{key:"create",value:function(e){var t=this,n=e.volumeConfig;this.soundManager=new Ie({scene:this,volumeConfig:n||Ln({},J)}),this.isPlayerDisabled=!1,this.tilemap=this.make.tilemap({key:"mapL4"});var r=this.tilemap.addTilesetImage("industrial.v2","tiles");this.tilemap.createDynamicLayer("background",r),this.obstacles=this.tilemap.createDynamicLayer("obstacles",r),this.tilemap.createDynamicLayer("foreground",r).setDepth(10),it(this,this.soundManager),this.createSpikes(),this.createPlayer(),this.createLever(),this.createTracks(),this.createHidingPlatform(),this.createJumper(),this.createSphere(),this.obstacles.setCollisionByProperty({collides:!0}),this.physics.world.addCollider(this.player.sprite,this.obstacles),this.cameras.main.startFollow(this.player.sprite,!0,.1,.1),this.cameras.main.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels),this.soundManager.isBGMusicPlaying()||this.soundManager.playBGMusic(),this.sys.game.device.input.touch&&setTimeout((function(){t.scale.startFullscreen()}),1e3)}},{key:"getPoint",value:function(e,t){return this.tilemap.findObject(e,(function(e){return e.name===t}))}},{key:"getPoints",value:function(e,t){var n=this;return t.map((function(t){return n.getPoint(e,t)}))}},{key:"createSpikes",value:function(){var e=this;this.spikes=this.physics.add.staticGroup(),this.obstacles.forEachTile((function(t){if(77===t.index){var n=e.spikes.create(t.getCenterX(),t.getCenterY(),"spike");n.rotation=t.rotation,0===n.angle?n.body.setSize(32,6).setOffset(0,26):-90===n.angle?n.body.setSize(6,32).setOffset(26,0):90===n.angle?n.body.setSize(6,32).setOffset(0,0):-180===n.angle&&n.body.setSize(32,6).setOffset(0,0),e.obstacles.removeTileAt(t.x,t.y)}}))}},{key:"createPlayer",value:function(){var e=this.getPoint("points","spawn"),t=e.x,n=e.y;this.player=new oe({scene:this,x:t,y:n,soundManager:this.soundManager})}},{key:"createLever",value:function(){var e=this,t=this.getPoint("points","lever"),n=t.x,r=t.y;this.lever=new Se({scene:this,x:n,y:r,soundManager:this.soundManager,onSwitchOn:function(){e.platforms.forEach((function(e){return e.switch()}))},onSwitchOff:function(){e.platforms.forEach((function(e){return e.switch()}))}})}},{key:"createTracks",value:function(){var e=this;this.tracks=this.physics.add.group({allowGravity:!1}),this.getPoints("points",["track1","track2","track3"]).forEach((function(t,n){var r=t.x,i=t.y;e.tracks.add(new In({scene:e,x:r,y:i,dir:1===n?"right":"left"}))}))}},{key:"createHidingPlatform",value:function(){var e=this;this.platforms=[],this.getPoints("points",["platform1","platform2","platform3","platform4"]).forEach((function(t){var n=t.x,r=t.y,i=new Re({scene:e,x:n,y:r,tilemap:e.obstacles});e.platforms.push(i)}))}},{key:"createJumper",value:function(){var e=this.getPoint("points","jumper"),t=e.x,n=e.y;this.jumper=new jt({scene:this,x:t,y:n,tile:this.obstacles.getTileAtWorldXY(t,n),soundManager:this.soundManager})}},{key:"createSphere",value:function(){var e=this.getPoint("points","sphere"),t=e.x,n=e.y;this.sphere=new he({scene:this,x:t,y:n,onEnter:this.nextLevel})}},{key:"checkLeversOverlap",value:function(){this.physics.world.overlap(this.lever,this.player.flash,(function(e){e.switch()}))}},{key:"checkTracksOverlap",value:function(){var e=this;this.player.deltaHorAcceleration=0,this.physics.world.overlap(this.tracks,this.player.sprite,(function(t,n){var r=n;e.player.deltaHorAcceleration=r.power}))}},{key:"checkJumperOverlap",value:function(){this.physics.world.overlap(this.jumper,this.player.sprite,(function(e,t){e.switch(),t.setVelocityY(-600)}))}},{key:"checkSphereOverlap",value:function(){this.physics.world.overlap(this.sphere,this.player.sprite,(function(e){e.activate()}))}},{key:"checkGameOver",value:function(){return this.physics.world.overlap(this.player.sprite,this.spikes)||this.player.sprite.y>this.obstacles.height}},{key:"restart",value:function(){var e=this;this.isPlayerDisabled=!0;var t=this.cameras.main;t.shake(100,.05),t.fade(250,0,0,0),this.player.freeze(),this.soundManager.die(),t.once("camerafadeoutcomplete",(function(){e.player.destroy(),e.scene.restart()}))}},{key:"update",value:function(){this.isPlayerDisabled||(this.player.update(),this.checkLeversOverlap(),this.checkTracksOverlap(),this.checkJumperOverlap(),this.checkSphereOverlap(),this.checkGameOver()&&this.restart())}}])&&zn(t.prototype,n),r&&zn(t,r),o}(i.a.Scene);function Wn(e){return(Wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yn(e,t){return(Yn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qn(e);if(t){var i=Qn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return $n(this,n)}}function $n(e,t){return!t||"object"!==Wn(t)&&"function"!=typeof t?qn(e):t}function qn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qn(e){return(Qn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var er=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yn(e,t)}(a,e);var t,n,r,o=Kn(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Zn(qn(t=o.call(this,e.scene,e.x,e.y,"steam_big",0)),"props",void 0),Zn(qn(t),"timer",void 0),t.props=e,t.createAnimation(),t.init(),t.createTimer(),t}return t=a,(n=[{key:"createAnimation",value:function(){var e=this;this.scene.anims.create({key:"steam-big",frames:this.scene.anims.generateFrameNumbers("steam_big",{start:0,end:9}),frameRate:12,hideOnComplete:!0}),this.on(i.a.Animations.Events.SPRITE_ANIMATION_START,(function(){e.visible=!0,e.body.enable=!0})),this.on(i.a.Animations.Events.SPRITE_ANIMATION_COMPLETE,(function(){e.body.enable=!1}))}},{key:"init",value:function(){var e=this.props.dir;switch(this.visible=!1,this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0),this.body.setSize(110,46),e){case"left":this.angle=-90,this.body.setSize(46,110);break;case"right":this.angle=90,this.body.setSize(46,110);break;case"down":this.angle=180}this.scene.add.existing(this)}},{key:"createTimer",value:function(){var e=this,t=this.props.delay;this.timer=this.scene.time.addEvent({startAt:0,delay:t||800,callback:function(){e.play("steam-big"),e.props.soundManager.steamBig(e.x,e.y)},loop:!0})}},{key:"stop",value:function(){this.timer.paused=!0,this.body.enable=!1}}])&&Jn(t.prototype,n),r&&Jn(t,r),a}(i.a.GameObjects.Sprite);function tr(e){return(tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rr(e,t){return(rr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ir(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sr(e);if(t){var i=sr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return or(this,n)}}function or(e,t){return!t||"object"!==tr(t)&&"function"!=typeof t?ar(e):t}function ar(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sr(e){return(sr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ur=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rr(e,t)}(o,e);var t,n,r,i=ir(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),cr(ar(t=i.call(this,e.scene,e.start.x,e.start.y,"steam_small",0)),"props",void 0),cr(ar(t),"dir",void 0),cr(ar(t),"defaultSize",void 0),cr(ar(t),"defaultOffset",void 0),cr(ar(t),"timer",null),cr(ar(t),"switchedOn",void 0),cr(ar(t),"setInitialState",(function(){var e=t.props.start,n=e.x,r=e.y;t.body.enable=!1,t.body.setSize(t.defaultSize.x,t.defaultSize.y),t.body.setOffset(t.defaultOffset.x,t.defaultOffset.y),"up"===t.dir||"down"===t.dir?t.y=r:t.x=n})),cr(ar(t),"fire",(function(){t.play("steam-small"),t.props.soundManager.steamSmall(t.x,t.y),t.visible=!0,t.body.enable=!0,t.scene.tweens.add({targets:ar(t),x:t.props.end.x,ease:"Linear",duration:1e3,onComplete:t.setInitialState,onUpdate:function(e,n){switch(t.dir){case"left":t.body.setSize(t.defaultSize.x-n.frame.name,t.defaultSize.y),t.body.setOffset(t.defaultOffset.x+n.frame.name,t.defaultOffset.y);break;case"right":t.body.setSize(t.defaultSize.x-n.frame.name,t.defaultSize.y),t.body.setOffset(t.defaultOffset.x,t.defaultOffset.y);break;case"down":t.body.setSize(t.defaultSize.x,t.defaultSize.y-n.frame.name),t.body.setOffset(t.defaultOffset.x,t.defaultOffset.y);break;default:t.body.setSize(t.defaultSize.x,t.defaultSize.y-n.frame.name),t.body.setOffset(t.defaultOffset.x,t.defaultOffset.y+n.frame.name)}}})})),t.props=e,t.createAnimation(),t.init(),t}return t=o,(n=[{key:"createAnimation",value:function(){this.scene.anims.create({key:"steam-small",frames:this.scene.anims.generateFrameNumbers("steam_small",{start:0,end:11}),frameRate:12,hideOnComplete:!0})}},{key:"createTimer",value:function(){this.timer=this.scene.time.addEvent({delay:1500,callback:this.fire,loop:!0})}},{key:"init",value:function(){var e,t,n=this.props,r=n.switchedOn,i=n.start,o=n.end;switch(this.visible=!1,this.switchedOn=null==r||r,this.dir=(t=o,(e=i).x!==t.x?e.x>t.x?"left":"right":e.y>t.y?"down":"up"),this.scene.physics.add.existing(this),this.body.setMaxVelocity(0,0),this.body.setSize(20,20),this.body.setOffset(5,8),this.dir){case"left":this.angle=-90,this.defaultSize={x:20,y:20},this.defaultOffset={x:8,y:8};break;case"right":this.angle=90,this.defaultSize={x:20,y:20},this.defaultOffset={x:2,y:8};break;case"down":this.angle=180,this.defaultSize={x:20,y:20},this.defaultOffset={x:6,y:4};break;default:this.defaultSize={x:20,y:20},this.defaultOffset={x:5,y:8}}this.scene.add.existing(this),this.switchedOn&&this.createTimer()}},{key:"switch",value:function(){this.switchedOn||this.timer||this.createTimer(),this.switchedOn=!this.switchedOn}}])&&nr(t.prototype,n),r&&nr(t,r),o}(i.a.GameObjects.Sprite);function lr(e){return(lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pr(e,t){return(pr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=mr(e);if(t){var i=mr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return yr(this,n)}}function yr(e,t){return!t||"object"!==lr(t)&&"function"!=typeof t?dr(e):t}function dr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mr(e){return(mr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function br(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pr(e,t)}(o,e);var t,n,r,i=hr(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),br(dr(t=i.call(this,e.scene,e.x,e.y,"tube_switcher",0)),"props",void 0),br(dr(t),"lastSwitchTime",Date.now()),br(dr(t),"turns",3),t.props=e,t.init(),t}return t=o,(n=[{key:"init",value:function(){this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0)}},{key:"switch",value:function(){var e,t,n=Date.now();if(!(n-this.lastSwitchTime<500)){null===(e=(t=this.props).onSwitch)||void 0===e||e.call(t);var r=360===this.angle?0:this.angle+90;this.scene.tweens.add({targets:this,angle:r,ease:"Linear",duration:200}),this.lastSwitchTime=n,this.turns-=1,0===this.turns&&(this.body.enable=!1,this.setFrame(1),this.props.onComplete())}}}])&&fr(t.prototype,n),r&&fr(t,r),o}(i.a.GameObjects.Sprite);function gr(e){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Or(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return wr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Sr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sr(Object(n),!0).forEach((function(t){Dr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kr(e,t){return(kr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Er(e);if(t){var i=Er(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return xr(this,n)}}function xr(e,t){return!t||"object"!==gr(t)&&"function"!=typeof t?Tr(e):t}function Tr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Er(e){return(Er=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Rr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kr(e,t)}(o,e);var t,n,r,i=_r(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Dr(Tr(e=i.call(this,"L5")),"timer",void 0),Dr(Tr(e),"soundManager",void 0),Dr(Tr(e),"player",void 0),Dr(Tr(e),"isPlayerDisabled",void 0),Dr(Tr(e),"timeoutIds",[]),Dr(Tr(e),"toast",void 0),Dr(Tr(e),"tilemap",void 0),Dr(Tr(e),"obstacles",void 0),Dr(Tr(e),"spikes",void 0),Dr(Tr(e),"hazards",void 0),Dr(Tr(e),"switchers",void 0),Dr(Tr(e),"steam1",void 0),Dr(Tr(e),"jumper",void 0),Dr(Tr(e),"sphere",void 0),Dr(Tr(e),"nextLevel",(function(){e.isPlayerDisabled=!0;var t=e.cameras.main;t.zoomTo(2,1e3),e.player.freeze(),e.clearTimers(),e.soundManager.stopBGMusic(),e.soundManager.sphere(),t.once("camerazoomcomplete",(function(){t.fade(1e3,29,33,45)})),t.once("camerafadeoutcomplete",(function(){e.player.destroy(),e.scene.restart()}))})),e}return t=o,(n=[{key:"create",value:function(e){var t=this,n=e.volumeConfig;this.soundManager=new Ie({scene:this,volumeConfig:n||Pr({},J)}),this.isPlayerDisabled=!1,this.tilemap=this.make.tilemap({key:"mapL5"});var r=this.tilemap.addTilesetImage("industrial.v2","tiles");this.tilemap.createDynamicLayer("background",r),this.obstacles=this.tilemap.createDynamicLayer("obstacles",r),this.tilemap.createDynamicLayer("foreground",r).setDepth(10),it(this,this.soundManager),this.createHelpToast(),this.createPlayer(),this.createHazards(),this.createTubeSwitchers(),this.createJumper(),this.createSphere(),this.obstacles.setCollisionByProperty({collides:!0}),this.physics.world.addCollider(this.player.sprite,this.obstacles),this.cameras.main.startFollow(this.player.sprite,!0,.1,.1),this.cameras.main.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels),this.soundManager.isBGMusicPlaying()||this.soundManager.playBGMusic(),this.sys.game.device.input.touch&&setTimeout((function(){t.scale.startFullscreen()}),1e3),this.time.addEvent({delay:1e3,callback:function(){t.toast.show()}})}},{key:"getPoint",value:function(e,t){return this.tilemap.findObject(e,(function(e){return e.name===t}))}},{key:"getPoints",value:function(e,t){var n=this;return t.map((function(t){return n.getPoint(e,t)}))}},{key:"hideLines",value:function(e){for(var t=this,n=function(e){var n=setTimeout((function(){t.tilemap.getObjectLayer("line".concat(e)).objects.forEach((function(e,n){var r=e.x,i=e.y;setTimeout((function(){var e=t.obstacles.getTileAtWorldXY(r,i);t.tweens.add({targets:e,alpha:0,ease:"Linear",duration:500,onComplete:function(){t.obstacles.removeTileAtWorldXY(r,i)}})}),100*n)}))}),1500*e);t.timeoutIds.push(n)},r=1;r<=e;r++)n(r)}},{key:"clearTimers",value:function(){this.timeoutIds.forEach((function(e){return clearTimeout(e)})),this.timeoutIds=[]}},{key:"createHelpToast",value:function(){this.toast=new M({scene:this,x:16,y:16,text:"Hit switcher several times"})}},{key:"createPlayer",value:function(){var e=this.getPoint("points","spawn"),t=e.x,n=e.y;this.player=new oe({scene:this,x:t,y:n,soundManager:this.soundManager})}},{key:"createHazards",value:function(){var e=this;this.hazards=this.physics.add.group({allowGravity:!1});var t=this.getPoint("points","steam1");this.steam1=new er({scene:this,x:t.x,y:t.y,soundManager:this.soundManager}),this.hazards.add(this.steam1);var n=this.getPoint("points","steam2");this.hazards.add(new er({scene:this,x:n.x,y:n.y,dir:"left",delay:3e3,soundManager:this.soundManager})),[this.getPoints("points",["steam_s_1_start","steam_s_1_end"]),this.getPoints("points",["steam_s_2_start","steam_s_2_end"]),this.getPoints("points",["steam_s_3_start","steam_s_3_end"])].forEach((function(t,n){var r=Or(t,2),i=r[0],o=r[1],a=new ur({scene:e,start:i,end:o,switchedOn:!1,soundManager:e.soundManager});e.hazards.add(a),e.time.addEvent({delay:1e3*n,callback:function(){return a.switch()},loop:!0})}))}},{key:"createTubeSwitchers",value:function(){var e=this;this.switchers=this.physics.add.group({allowGravity:!1});var t=this.getPoint("points","tube_switcher1");this.switchers.add(new vr({scene:this,x:t.x,y:t.y,soundManager:this.soundManager,onComplete:function(){e.steam1.stop(),e.toast.hide((function(){e.toast.setValue("Hurry up!"),e.toast.show(),e.hideLines(10)}))}}))}},{key:"createJumper",value:function(){var e=this.getPoint("points","jumper"),t=e.x,n=e.y;this.jumper=new jt({scene:this,x:t,y:n,tile:this.obstacles.getTileAtWorldXY(t,n),soundManager:this.soundManager})}},{key:"createSphere",value:function(){var e=this.getPoint("points","sphere"),t=e.x,n=e.y;this.sphere=new he({scene:this,x:t,y:n,onEnter:this.nextLevel})}},{key:"checkSwitchersOverlap",value:function(){this.physics.world.overlap(this.switchers,this.player.flash,(function(e,t){t.switch()}))}},{key:"checkJumpersOverlap",value:function(){this.physics.world.overlap(this.jumper,this.player.sprite,(function(e,t){e.switch(),t.setVelocityY(-650)}))}},{key:"checkSphereOverlap",value:function(){this.physics.world.overlap(this.sphere,this.player.sprite,(function(e){e.activate()}))}},{key:"checkGameOver",value:function(){return this.player.sprite.y>this.obstacles.height||this.physics.world.overlap(this.player.sprite,this.hazards)}},{key:"restart",value:function(){var e=this;this.isPlayerDisabled=!0;var t=this.cameras.main;t.shake(100,.05),t.fade(250,0,0,0),this.player.freeze(),this.clearTimers(),this.soundManager.die(),t.once("camerafadeoutcomplete",(function(){e.player.destroy(),e.scene.restart()}))}},{key:"update",value:function(){this.isPlayerDisabled||(this.player.update(),this.checkSwitchersOverlap(),this.checkJumpersOverlap(),this.checkSphereOverlap(),this.checkGameOver()&&this.restart())}}])&&jr(t.prototype,n),r&&jr(t,r),o}(i.a.Scene);function Mr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mr(Object(n),!0).forEach((function(t){Ir(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ir(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(1755);var Ar,Nr=(Ar=[P,dt,nn,kn,Xn,Rr],Cr(Cr({},{width:736,height:416}),{},{scene:Ar,type:i.a.AUTO,scale:{mode:i.a.Scale.FIT,autoCenter:i.a.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{debug:!1,gravity:{y:1e3}}},input:{gamepad:!0},parent:document.getElementById("app"),backgroundColor:"#1d212d",pixelArt:!0,callbacks:{preBoot:function(e){e.device.input.touch&&document.body.classList.add("touch")}}}));new i.a.Game(Nr)},667:function(e,t,n){n(668),e.exports=n(1756)}});