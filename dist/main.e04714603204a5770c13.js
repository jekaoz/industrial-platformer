!function(e){function t(t){for(var r,s,a=t[0],c=t[1],u=t[2],f=0,p=[];f<a.length;f++)s=a[f],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&p.push(i[s][0]),i[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(t);p.length;)p.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,a=1;a<n.length;a++){var c=n[a];0!==i[c]&&(r=!1)}r&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},i={0:0},o=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var a=window.webpackJsonp=window.webpackJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=c;o.push([667,1]),n()}({1755:function(e,t,n){},1756:function(e,t,n){"use strict";n.r(t);var r=n(5),i=n.n(r);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(n,Phaser.Renderer.WebGL.Pipelines.TextureTintPipeline);var t=a(n);function n(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this,{game:e,renderer:e.renderer,fragShader:"\n            precision mediump float;\n\n            uniform float time;\n            uniform sampler2D uMainSampler;\n            varying vec2 outTexCoord;\n\n            void main(void) {\n                vec4 color = texture2D(uMainSampler, outTexCoord);\n                if (color.a != 0.0) {\n                    gl_FragColor = mix(color, vec4(1.0), cos(time / 50.0));\n                }\n            }"})}return n}();function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g(e);if(t){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v(this,n)}}function v(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w="../assets",O={SPRITESHEET:"".concat(w,"/spritesheets"),IMAGES:"".concat(w,"/images"),TILESETS:"".concat(w,"/tilesets"),TILEMAPS:"".concat(w,"/tilemaps"),SOUNDS:"".concat(w,"/sounds")},S={frameWidth:32,frameHeight:32},P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(o,e);var t,n,r,i=b(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"Boot")}return t=o,(n=[{key:"preload",value:function(){var e=this.cameras.main.width,t=this.cameras.main.height,n=this.add.graphics(),r=this.add.graphics();r.fillStyle(3094089,.8),r.fillRect(e/2-160-10,t/2-30,320,50),this.make.text({x:e/2,y:t/2-50,text:"Loading...",style:{font:"20px monospace",fill:"#ffffff"}}).setOrigin(.5,.5);var i=this.make.text({x:e/2,y:t/2-5,text:"0%",style:{font:"18px monospace",fill:"#ffffff"}});i.setOrigin(.5,.5),this.load.on("progress",(function(r){n.clear(),n.fillStyle(16777215,1),n.fillRect(e/2-160,t/2-20,300*r,30),i.setText(parseInt(String(100*r),10)+"%")})),this.load.spritesheet("player","".concat(O.SPRITESHEET,"/player.png"),h(h({},S),{},{margin:1,spacing:2})),this.load.spritesheet("player_flash","".concat(O.SPRITESHEET,"/player_flash.png"),{frameWidth:48,frameHeight:32}),this.load.spritesheet("gun_bullet","".concat(O.SPRITESHEET,"/gun_bullet.png"),{frameWidth:10,frameHeight:10}),this.load.spritesheet("sphere","".concat(O.SPRITESHEET,"/sphere.png"),S),this.load.spritesheet("gun","".concat(O.SPRITESHEET,"/gun.png"),S),this.load.spritesheet("button","".concat(O.SPRITESHEET,"/button.png"),S),this.load.spritesheet("lever","".concat(O.SPRITESHEET,"/lever.png"),S),this.load.spritesheet("hiding_platform","".concat(O.SPRITESHEET,"/hiding_platform.png"),S),this.load.spritesheet("reflector","".concat(O.SPRITESHEET,"/reflector.png"),S),this.load.spritesheet("glorg","".concat(O.SPRITESHEET,"/glorg.png"),S),this.load.spritesheet("charger","".concat(O.SPRITESHEET,"/charger.png"),S),this.load.spritesheet("robot1","".concat(O.SPRITESHEET,"/robot1.png"),S),this.load.spritesheet("bat","".concat(O.SPRITESHEET,"/bat.png"),{frameWidth:16,frameHeight:16}),this.load.spritesheet("button_music","".concat(O.SPRITESHEET,"/button_music.png"),S),this.load.spritesheet("button_sfx","".concat(O.SPRITESHEET,"/button_sfx.png"),S),this.load.spritesheet("button_left","".concat(O.SPRITESHEET,"/button_left.png"),{frameWidth:64,frameHeight:64}),this.load.spritesheet("button_right","".concat(O.SPRITESHEET,"/button_right.png"),{frameWidth:64,frameHeight:64}),this.load.spritesheet("button_up","".concat(O.SPRITESHEET,"/button_up.png"),{frameWidth:64,frameHeight:64}),this.load.spritesheet("button_hit","".concat(O.SPRITESHEET,"/button_hit.png"),{frameWidth:64,frameHeight:64}),this.load.image("spike","".concat(O.IMAGES,"/spike.png")),this.load.image("jumper_opened","".concat(O.IMAGES,"/jumper_opened.png")),this.load.image("tiles","".concat(O.TILESETS,"/industrial.png")),this.load.tilemapTiledJSON("mapL1","".concat(O.TILEMAPS,"/warehouse_v2_L1.json")),this.load.tilemapTiledJSON("mapL2","".concat(O.TILEMAPS,"/warehouse_v2_L2.json")),this.load.tilemapTiledJSON("mapL3","".concat(O.TILEMAPS,"/warehouse_v2_L3.json")),this.load.audio("bg_1",["".concat(O.SOUNDS,"/background/bg_1.ogg"),"".concat(O.SOUNDS,"/background/bg_1.mp3")]),this.load.audio("die",["".concat(O.SOUNDS,"/player/die.ogg"),"".concat(O.SOUNDS,"/player/die.mp3")]),this.load.audio("jump",["".concat(O.SOUNDS,"/player/jump.ogg"),"".concat(O.SOUNDS,"/player/jump.mp3")]),this.load.audio("land",["".concat(O.SOUNDS,"/player/land.ogg"),"".concat(O.SOUNDS,"/player/land.mp3")]),this.load.audio("hit",["".concat(O.SOUNDS,"/player/hit.ogg"),"".concat(O.SOUNDS,"/player/hit.mp3")]),this.load.audio("step",["".concat(O.SOUNDS,"/player/step.ogg"),"".concat(O.SOUNDS,"/player/step.mp3")]),this.load.audio("sphere",["".concat(O.SOUNDS,"/environment/sphere.ogg"),"".concat(O.SOUNDS,"/environment/sphere.mp3")]),this.load.audio("gun",["".concat(O.SOUNDS,"/environment/gun.ogg"),"".concat(O.SOUNDS,"/environment/gun.mp3")]),this.load.audio("lever",["".concat(O.SOUNDS,"/environment/lever.ogg"),"".concat(O.SOUNDS,"/environment/lever.mp3")]),this.load.audio("jumper",["".concat(O.SOUNDS,"/environment/jumper.ogg"),"".concat(O.SOUNDS,"/environment/jumper.mp3")]),this.load.audio("reflector",["".concat(O.SOUNDS,"/environment/reflector.ogg"),"".concat(O.SOUNDS,"/environment/reflector.mp3")]),this.load.audio("reflector_collide",["".concat(O.SOUNDS,"/environment/reflector_collide.ogg"),"".concat(O.SOUNDS,"/environment/reflector_collide.mp3")])}},{key:"addPipelines",value:function(){this.game.renderer.addPipeline("blink",new l(this.game))}},{key:"create",value:function(){this.addPipelines(),this.scene.start("L1")}}])&&d(t.prototype,n),r&&d(t,r),o}(i.a.Scene);function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M(e);if(t){var i=M(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return E(this,n)}}function E(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?T(e):t}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D,C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(s,e);var t,n,r,o=_(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),R(T(t=o.call(this,e.scene,e.x,e.y,e.texture,0)),"props",void 0),R(T(t),"switchedOn",void 0),R(T(t),"lastSwitchTime",Date.now()),t.props=e,t.init(),t}return t=s,(n=[{key:"init",value:function(){var e=this.props.switchedOn,t=void 0===e||e;this.switchedOn=t,this.switchedOn||this.setFrame(1),this.scene.add.existing(this),this.setScrollFactor(0),this.setInteractive(),this.on(i.a.Input.Events.POINTER_DOWN,this.switch)}},{key:"switchOn",value:function(){this.setFrame(0),this.props.onSwitchOn(),this.switchedOn=!0}},{key:"switchOff",value:function(){var e,t;this.setFrame(1),null===(e=(t=this.props).onSwitchOff)||void 0===e||e.call(t),this.switchedOn=!1}},{key:"switch",value:function(){this.switchedOn?this.switchOff():this.switchOn()}}])&&j(t.prototype,n),r&&j(t,r),s}(i.a.GameObjects.Sprite);function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A="step",G="jump",L="land",N="hit",B="die",F="jumper",H="gun",U="reflector",z="reflector_collide",X="lever",V="sphere",W=(I(D={bg_1:.2},A,.5),I(D,G,.4),I(D,L,.4),I(D,N,.3),I(D,B,.5),I(D,F,.4),I(D,H,.5),I(D,U,.5),I(D,z,.5),I(D,X,.5),I(D,V,.5),D);function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Z(e);if(t){var i=Z(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return q(this,n)}}function q(e,t){return!t||"object"!==K(t)&&"function"!=typeof t?Q(e):t}function Q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(s,e);var t,n,r,o=$(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),ee(Q(t=o.call(this,e.scene,e.x,e.y,"button_".concat(e.type),0)),"props",void 0),ee(Q(t),"pressed",!1),t.props=e,t.init(),t}return t=s,(n=[{key:"init",value:function(){this.setScrollFactor(0).setInteractive().setAlpha(.25).on(i.a.Input.Events.POINTER_DOWN,this.switchOn).on(i.a.Input.Events.POINTER_OVER,this.switchOn).on(i.a.Input.Events.POINTER_UP,this.switchOff).on(i.a.Input.Events.POINTER_OUT,this.switchOff),this.scene.add.existing(this)}},{key:"switchOn",value:function(){var e,t;this.pressed||(this.setFrame(1),this.setAlpha(.5),this.pressed=!0,null===(e=(t=this.props).onSwitchOn)||void 0===e||e.call(t))}},{key:"switchOff",value:function(){var e,t;this.pressed&&(this.setFrame(0),this.setAlpha(.25),this.pressed=!1,null===(e=(t=this.props).onSwitchOff)||void 0===e||e.call(t))}}])&&Y(t.prototype,n),r&&Y(t,r),s}(i.a.GameObjects.Sprite);function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ie=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),re(this,"scene",void 0),re(this,"soundManager",void 0),re(this,"sprite",void 0),re(this,"flash",void 0),re(this,"keys",null),re(this,"leftBtn",null),re(this,"rightBtn",null),re(this,"upBtn",null),re(this,"hitBtn",null),re(this,"lastHitTime",Date.now()),this.scene=t.scene,this.soundManager=t.soundManager,this.createAnimations(),this.createControls(),this.createSprite(t.x,t.y)}var t,n,r;return t=e,(n=[{key:"createAnimations",value:function(){var e=this.scene.anims;e.create({key:"player-idle",frames:e.generateFrameNumbers("player",{start:0,end:3}),frameRate:4,repeat:-1}),e.create({key:"player-run",frames:e.generateFrameNumbers("player",{start:8,end:15}),frameRate:12,repeat:-1}),e.create({key:"player-land",frames:e.generateFrameNumbers("player",{start:4,end:7}),frameRate:12}),e.create({key:"player-hit",frames:e.generateFrameNumbers("player",{start:24,end:27}),frameRate:14}),e.create({key:"player-flash",frames:e.generateFrameNumbers("player_flash",{start:0,end:3}),frameRate:14,hideOnComplete:!0})}},{key:"createControls",value:function(){if(this.scene.sys.game.device.input.touch)this.scene.input.addPointer(4),this.leftBtn=new te({scene:this.scene,x:48,y:this.scene.cameras.main.height-48,type:"left"}),this.rightBtn=new te({scene:this.scene,x:118,y:this.scene.cameras.main.height-48,type:"right"}),this.hitBtn=new te({scene:this.scene,x:this.scene.cameras.main.width-48,y:this.scene.cameras.main.height-48,type:"hit"}),this.upBtn=new te({scene:this.scene,x:this.scene.cameras.main.width-48,y:this.scene.cameras.main.height-122,type:"up"});else{var e=i.a.Input.Keyboard.KeyCodes,t=e.SPACE,n=e.LEFT,r=e.RIGHT,o=e.UP,s=e.W,a=e.A,c=e.D;this.keys=this.scene.input.keyboard.addKeys({space:t,left:n,right:r,up:o,w:s,a:a,d:c})}}},{key:"createSprite",value:function(e,t){this.sprite=this.scene.physics.add.sprite(e,t,"player",0).setDrag(1e3,0).setMaxVelocity(200,1e3).setSize(18,24).setOffset(7,9).setDepth(2)}},{key:"createFlash",value:function(){var e=this;this.flash=this.scene.add.sprite(this.sprite.x,this.sprite.y,"player_flash",0).setFlipX(this.sprite.flipX).play("player-flash",!0).on(i.a.Animations.Events.SPRITE_ANIMATION_COMPLETE,(function(){e.flash.destroy()})),this.flash.x+=this.sprite.flipX?-this.flash.width/2-this.sprite.width/2:this.flash.width/2+this.sprite.width/2,this.scene.physics.add.existing(this.flash),this.flash.body.enable=!1,this.flash.body.setMaxVelocity(0,0).setSize(48,32),setTimeout((function(){e.flash.body.enable=!0}),0)}},{key:"hit",value:function(){var e,t;(null===(e=this.flash)||void 0===e||null===(t=e.anims)||void 0===t?void 0:t.isPlaying)||(this.createFlash(),this.soundManager.hit())}},{key:"freeze",value:function(){this.sprite.body.moves=!1}},{key:"update",value:function(){var e,t,n,r,i,o,s=this.keys,a=this.sprite,c=Date.now(),u=a.body.blocked.down,l=u?400:200,f=(null==s?void 0:s.left.isDown)||(null==s?void 0:s.a.isDown)||(null===(e=this.leftBtn)||void 0===e?void 0:e.pressed),p=(null==s?void 0:s.right.isDown)||(null==s?void 0:s.d.isDown)||(null===(t=this.rightBtn)||void 0===t?void 0:t.pressed),h=(null==s?void 0:s.up.isDown)||(null==s?void 0:s.w.isDown)||(null===(n=this.upBtn)||void 0===n?void 0:n.pressed),y=(null==s?void 0:s.space.isDown)||(null===(r=this.hitBtn)||void 0===r?void 0:r.pressed);f?(a.setAccelerationX(-l),a.setFlipX(!0),u&&!a.body.blocked.left&&this.soundManager.step()):p?(a.setAccelerationX(l),a.setFlipX(!1),u&&!a.body.blocked.right&&this.soundManager.step()):a.setAccelerationX(0),u&&h&&(this.soundManager.jump(),a.setVelocityY(-400)),y&&c-this.lastHitTime>=500&&(a.anims.play("player-hit",!0),this.lastHitTime=c,this.hit()),a.anims.isPlaying&&"player-hit"===(null===(i=a.anims.currentAnim)||void 0===i?void 0:i.key)||(a.body.deltaY()>.3&&u&&(a.anims.play("player-land",!0),this.soundManager.land()),a.anims.isPlaying&&"player-land"===(null===(o=a.anims.currentAnim)||void 0===o?void 0:o.key)||(u&&0===a.body.velocity.x?a.anims.play("player-idle",!0):u?a.anims.play("player-run",!0):(a.anims.stop(),a.setTexture("player",10))))}},{key:"destroy",value:function(){this.sprite.destroy()}}])&&ne(t.prototype,n),r&&ne(t,r),e}();function oe(e){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ae(e,t){return(ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fe(e);if(t){var i=fe(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ue(this,n)}}function ue(e,t){return!t||"object"!==oe(t)&&"function"!=typeof t?le(e):t}function le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ae(e,t)}(o,e);var t,n,r,i=ce(o);function o(e){var t,n,r,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),t=i.call(this,e.scene,e.x,e.y,"sphere",6),n=le(t),s=void 0,(r="props")in n?Object.defineProperty(n,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[r]=s,t.props=e,t.init(),t}return t=o,(n=[{key:"init",value:function(){this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0)}},{key:"activate",value:function(){this.props.onEnter()}}])&&se(t.prototype,n),r&&se(t,r),o}(i.a.GameObjects.Sprite);function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function de(e,t){return(de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ge(e);if(t){var i=ge(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return be(this,n)}}function be(e,t){return!t||"object"!==he(t)&&"function"!=typeof t?ve(e):t}function ve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function we(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&de(e,t)}(o,e);var t,n,r,i=me(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),we(ve(t=i.call(this,e.scene,e.x,e.y,"lever",0)),"props",void 0),we(ve(t),"lastSwitchTime",Date.now()),we(ve(t),"switchedOn",!1),t.props=e,t.init(),t}return t=o,(n=[{key:"init",value:function(){this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0),this.body.setSize(24,20),this.body.setOffset(6,12)}},{key:"blink",value:function(){var e=this;this.setPipeline("blink"),setTimeout((function(){return e.resetPipeline()}),50)}},{key:"checkSwitchAccessibility",value:function(){var e=Date.now();return!(e-this.lastSwitchTime<500||(this.lastSwitchTime=e,0))}},{key:"switchOn",value:function(){this.setFrame(4),this.props.onSwitchOn(),this.switchedOn=!0}},{key:"switchOff",value:function(){var e,t;this.setFrame(0),null===(e=(t=this.props).onSwitchOff)||void 0===e||e.call(t),this.switchedOn=!1}},{key:"switch",value:function(){this.checkSwitchAccessibility()&&(this.switchedOn?this.switchOff():this.switchOn(),this.blink(),this.props.soundManager.lever())}}])&&ye(t.prototype,n),r&&ye(t,r),o}(i.a.GameObjects.Sprite);function Se(e){return(Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ke(e,t){return(ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var i=Ee(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return xe(this,n)}}function xe(e,t){return!t||"object"!==Se(t)&&"function"!=typeof t?_e(e):t}function _e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ke(e,t)}(s,e);var t,n,r,o=je(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),Te(_e(t=o.call(this,e.scene,e.x,e.y,"hiding_platform",3)),"props",void 0),Te(_e(t),"lastSwitchTime",Date.now()),Te(_e(t),"shown",void 0),t.props=e,t.createAnimations(),t.init(),t}return t=s,(n=[{key:"createAnimations",value:function(){this.scene.anims.create({key:"platform-hide",frames:this.scene.anims.generateFrameNumbers("hiding_platform",{start:0,end:3}),frameRate:12}),this.scene.anims.create({key:"platform-show",frames:this.scene.anims.generateFrameNumbers("hiding_platform",{start:3,end:0}),frameRate:12})}},{key:"init",value:function(){var e=this.props.initialVisibility,t=void 0!==e&&e;this.shown=t,this.scene.add.existing(this)}},{key:"switch",value:function(){var e=this,t=Date.now();if(this.scene&&!(t-this.lastSwitchTime<500)){var n=this.shown?"platform-hide":"platform-show";this.lastSwitchTime=t,this.shown=!this.shown,this.shown||this.props.tilemap.removeTileAtWorldXY(this.x,this.y),this.play(n),this.on(i.a.Animations.Events.SPRITE_ANIMATION_COMPLETE,(function(){e.shown&&e.props.tilemap.putTileAtWorldXY(353,e.x,e.y).setCollision(!0)}))}}}])&&Pe(t.prototype,n),r&&Pe(t,r),s}(i.a.GameObjects.Sprite);function Re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function De(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ce=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),De(this,"manager",void 0),De(this,"bgKey","bg_1"),De(this,"volumeConfig",void 0),De(this,"lastStepTime",Date.now()),De(this,"bgMusicMuted",void 0),De(this,"sfxMuted",void 0),this.manager=t.manager,this.volumeConfig=t.volumeConfig,this.bgMusicMuted=0===this.volumeConfig[this.bgKey],this.sfxMuted=0===this.volumeConfig[G]}var t,n,r;return t=e,(n=[{key:"playBGMusic",value:function(){var e=this.manager.get(this.bgKey);e?e.play():this.manager.play(this.bgKey,{volume:.2,loop:!0})}},{key:"muteBGMusic",value:function(){this.manager.get(this.bgKey).volume=0,this.volumeConfig[this.bgKey]=0,this.bgMusicMuted=!0}},{key:"unmuteBGMusic",value:function(){var e=this.manager.get(this.bgKey);e.volume=W[this.bgKey],this.volumeConfig[this.bgKey]=W[this.bgKey],this.bgMusicMuted=!1,e.isPlaying||e.play()}},{key:"stopBGMusic",value:function(){this.manager.stopByKey(this.bgKey)}},{key:"step",value:function(){var e,t=A,n=Date.now();(null===(e=this.manager.get(A))||void 0===e?void 0:e.isPlaying)||n-this.lastStepTime<300||(this.lastStepTime=n,this.manager.play(t,{volume:this.volumeConfig[t]}))}},{key:"jump",value:function(){var e=G;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"land",value:function(){var e=L;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"hit",value:function(){var e=N;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"die",value:function(){var e=B;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"jumper",value:function(){var e=F;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"gun",value:function(){var e=H;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"reflector",value:function(){var e=U;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"reflectorCollide",value:function(){var e=z;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"lever",value:function(){var e=X;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"sphere",value:function(){var e=V;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"muteSFX",value:function(){var e=this;Object.keys(this.volumeConfig).forEach((function(t){t!==e.bgKey&&(e.volumeConfig[t]=0)})),this.sfxMuted=!0}},{key:"unmuteSFX",value:function(){var e=this;Object.keys(this.volumeConfig).forEach((function(t){t!==e.bgKey&&(e.volumeConfig[t]=W[t])})),this.sfxMuted=!1}}])&&Re(t.prototype,n),r&&Re(t,r),e}();function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(n),!0).forEach((function(t){ze(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ne(e,t){return(Ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ue(e);if(t){var i=Ue(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Fe(this,n)}}function Fe(e,t){return!t||"object"!==Ie(t)&&"function"!=typeof t?He(e):t}function He(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ne(e,t)}(o,e);var t,n,r,i=Be(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),ze(He(e=i.call(this,"L1")),"player",void 0),ze(He(e),"soundManager",void 0),ze(He(e),"isPlayerDisabled",void 0),ze(He(e),"tilemap",void 0),ze(He(e),"obstacles",void 0),ze(He(e),"sphere",void 0),ze(He(e),"platform",void 0),ze(He(e),"lever",void 0),ze(He(e),"nextLevel",(function(){e.isPlayerDisabled=!0;var t=e.cameras.main;t.zoomTo(2,1e3),e.player.freeze(),e.soundManager.stopBGMusic(),e.soundManager.sphere(),t.once("camerazoomcomplete",(function(){t.fade(1e3,29,33,45)})),t.once("camerafadeoutcomplete",(function(){var t=e.soundManager.volumeConfig;e.player.destroy(),e.scene.start("L2",{volumeConfig:t})}))})),e}return t=o,(n=[{key:"create",value:function(e){var t=this,n=e.volumeConfig;this.soundManager=new Ce({manager:this.sound,volumeConfig:n||Ge({},W)}),this.isPlayerDisabled=!1,this.add.text(16,16,"Arrow keys or WASD to move & jump\nSpace to hit",{font:"18px monospace",fill:"#000000",padding:{x:20,y:10},backgroundColor:"#ffffff"}).setScrollFactor(0).setDepth(11),this.tilemap=this.make.tilemap({key:"mapL1"});var r=this.tilemap.addTilesetImage("industrial.v2","tiles");this.tilemap.createDynamicLayer("background",r),this.obstacles=this.tilemap.createDynamicLayer("obstacles",r),this.tilemap.createDynamicLayer("foreground",r).setDepth(10),this.createUI(),this.createPlayer(),this.createHidingPlatform(),this.createLever(),this.createSphere(),this.obstacles.setCollisionByProperty({collides:!0}),this.physics.world.addCollider(this.player.sprite,this.obstacles),this.cameras.main.startFollow(this.player.sprite,!0,.1,.1),this.cameras.main.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels),this.soundManager.bgMusicMuted||this.soundManager.playBGMusic(),this.sys.game.device.input.touch&&setTimeout((function(){t.scale.startFullscreen()}),1e3)}},{key:"getPoint",value:function(e,t){return this.tilemap.findObject(e,(function(e){return e.name===t}))}},{key:"createUI",value:function(){var e=this,t=this.soundManager,n=t.bgMusicMuted,r=t.sfxMuted;new C({scene:this,texture:"button_music",x:this.cameras.main.width-32,y:32,switchedOn:!n,onSwitchOn:function(){e.soundManager.unmuteBGMusic()},onSwitchOff:function(){e.soundManager.muteBGMusic()}}),new C({scene:this,texture:"button_sfx",x:this.cameras.main.width-32,y:74,switchedOn:!r,onSwitchOn:function(){e.soundManager.unmuteSFX()},onSwitchOff:function(){e.soundManager.muteSFX()}})}},{key:"createPlayer",value:function(){var e=this.getPoint("points","spawn"),t=e.x,n=e.y;this.player=new ie({scene:this,x:t,y:n,soundManager:this.soundManager})}},{key:"createHidingPlatform",value:function(){var e=this.getPoint("points","platform"),t=e.x,n=e.y;this.platform=new Me({scene:this,x:t,y:n,tilemap:this.obstacles})}},{key:"createLever",value:function(){var e=this,t=this.getPoint("points","lever"),n=t.x,r=t.y;this.lever=new Oe({scene:this,x:n,y:r,soundManager:this.soundManager,onSwitchOn:function(){e.platform.switch()},onSwitchOff:function(){e.platform.switch()}})}},{key:"createSphere",value:function(){var e=this.getPoint("points","sphere"),t=e.x,n=e.y;this.sphere=new pe({scene:this,x:t,y:n,onEnter:this.nextLevel})}},{key:"checkLeversOverlap",value:function(){this.physics.world.overlap(this.lever,this.player.flash,(function(e){e.switch()}))}},{key:"checkSphereOverlap",value:function(){this.physics.world.overlap(this.sphere,this.player.sprite,(function(e){e.activate()}))}},{key:"checkGameOver",value:function(){return this.player.sprite.y>this.obstacles.height}},{key:"restart",value:function(){var e=this;this.isPlayerDisabled=!0;var t=this.cameras.main;t.shake(100,.05),t.fade(250,0,0,0),this.player.freeze(),this.soundManager.stopBGMusic(),this.soundManager.die(),t.once("camerafadeoutcomplete",(function(){var t=e.soundManager.volumeConfig;e.player.destroy(),e.scene.restart({volumeConfig:t})}))}},{key:"update",value:function(){this.isPlayerDisabled||(this.player.update(),this.checkLeversOverlap(),this.checkSphereOverlap(),this.checkGameOver()&&this.restart())}}])&&Le(t.prototype,n),r&&Le(t,r),o}(i.a.Scene);function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ke(e,t){return(Ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qe(e);if(t){var i=qe(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Je(this,n)}}function Je(e,t){return!t||"object"!==Ve(t)&&"function"!=typeof t?$e(e):t}function $e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qe(e){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ze=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ke(e,t)}(o,e);var t,n,r,i=Ye(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Qe($e(t=i.call(this,e.scene,e.x,e.y,"jumper_opened")),"props",void 0),Qe($e(t),"id",void 0),Qe($e(t),"lastSwitchTime",Date.now()),Qe($e(t),"opened",!1),Qe($e(t),"toggleView",(function(){t.opened?(t.props.tile.visible=!1,t.visible=!0):(t.props.tile.visible=!0,t.visible=!1)})),t.props=e,t.id=e.id,t.init(),t}return t=o,(n=[{key:"init",value:function(){this.visible=!1,this.y-=16,this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0),this.body.setSize(28,2),this.body.setOffset(2,31),this.scene.add.existing(this)}},{key:"switch",value:function(){var e=this,t=Date.now();t-this.lastSwitchTime<500||(this.opened=!this.opened,this.lastSwitchTime=t,this.toggleView(),setTimeout((function(){e.opened=!e.opened,e.toggleView()}),500),this.props.soundManager.jumper())}}])&&We(t.prototype,n),r&&We(t,r),o}(i.a.GameObjects.Sprite);function et(e){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&it(e,t)}function it(e,t){return(it=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ot(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ct(e);if(t){var i=ct(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return st(this,n)}}function st(e,t){return!t||"object"!==et(t)&&"function"!=typeof t?at(e):t}function at(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ct(e){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var lt=function(e){rt(n,e);var t=ot(n);function n(e,r,i,o){var s;return nt(this,n),ut(at(s=t.call(this,e,i,o,"gun_bullet",0)),"dir",void 0),s.dir=r,s.scene.add.existing(at(s)),s.scene.physics.add.existing(at(s)),s.body.setAllowGravity(!1),s.body.setVelocityX(500),s}return n}(i.a.GameObjects.Sprite),ft=function(e){rt(o,e);var t,n,r,i=ot(o);function o(e){var t;return nt(this,o),ut(at(t=i.call(this,e.scene,e.x,e.y,"gun",0)),"props",void 0),ut(at(t),"lastShootTime",Date.now()),ut(at(t),"opened",!1),t.props=e,t.createAnimation(),t.init(),t.play("gun-idle"),t}return t=o,(n=[{key:"createAnimation",value:function(){this.scene.anims.create({key:"gun-idle",frames:this.scene.anims.generateFrameNumbers("gun",{start:0,end:2}),frameRate:4,repeat:-1})}},{key:"init",value:function(){this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0)}},{key:"shoot",value:function(){var e=this,t=Date.now();if(!(t-this.lastShootTime<500)){var n=new lt(this.scene,this.props.dir,this.x,this.y);this.props.group.add(n),this.setPipeline("blink"),setTimeout((function(){return e.resetPipeline()}),50),this.lastShootTime=t,this.props.soundManager.gun()}}}])&&tt(t.prototype,n),r&&tt(t,r),o}(i.a.GameObjects.Sprite);function pt(e){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ht(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yt(e,t){return(yt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vt(e);if(t){var i=vt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return mt(this,n)}}function mt(e,t){return!t||"object"!==pt(t)&&"function"!=typeof t?bt(e):t}function bt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vt(e){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var wt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yt(e,t)}(o,e);var t,n,r,i=dt(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),gt(bt(t=i.call(this,e.scene,e.x,e.y,"reflector",0)),"props",void 0),gt(bt(t),"lastSwitchTime",Date.now()),gt(bt(t),"lastCollisionTime",Date.now()),gt(bt(t),"opened",!1),t.props=e,t.init(),t}return t=o,(n=[{key:"init",value:function(){this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0)}},{key:"collide",value:function(){var e=this;this.setFrame(1),setTimeout((function(){e.setFrame(0)}),100),this.props.soundManager.reflectorCollide()}},{key:"switch",value:function(){var e,t,n=this,r=Date.now();if(!(r-this.lastSwitchTime<500)){null===(e=(t=this.props).onSwitch)||void 0===e||e.call(t);var i=360===this.angle?0:this.angle+90;this.scene.tweens.add({targets:this,angle:i,ease:"Linear",duration:200}),this.setPipeline("blink"),setTimeout((function(){return n.resetPipeline()}),50),this.lastSwitchTime=r,this.props.soundManager.reflector()}}}])&&ht(t.prototype,n),r&&ht(t,r),o}(i.a.GameObjects.Sprite);function Ot(e){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function St(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pt(e,t){return(Pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_t(e);if(t){var i=_t(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jt(this,n)}}function jt(e,t){return!t||"object"!==Ot(t)&&"function"!=typeof t?xt(e):t}function xt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _t(e){return(_t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Et(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Tt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pt(e,t)}(o,e);var t,n,r,i=kt(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Et(xt(e=i.call(this,"L2")),"player",void 0),Et(xt(e),"soundManager",void 0),Et(xt(e),"isPlayerDisabled",void 0),Et(xt(e),"tilemap",void 0),Et(xt(e),"obstacles",void 0),Et(xt(e),"spikes",void 0),Et(xt(e),"bullets",void 0),Et(xt(e),"reflectors",void 0),Et(xt(e),"sphere",void 0),Et(xt(e),"jumper",void 0),Et(xt(e),"lever",void 0),Et(xt(e),"gun",void 0),Et(xt(e),"nextLevel",(function(){e.isPlayerDisabled=!0;var t=e.cameras.main;t.zoomTo(2,1e3),e.player.freeze(),e.soundManager.stopBGMusic(),e.soundManager.sphere(),t.once("camerazoomcomplete",(function(){t.fade(1e3,29,33,45)})),t.once("camerafadeoutcomplete",(function(){var t=e.soundManager.volumeConfig;e.player.destroy(),e.scene.start("L3",{volumeConfig:t})}))})),e}return t=o,(n=[{key:"create",value:function(e){var t=e.volumeConfig;this.soundManager=new Ce({volumeConfig:t,manager:this.sound}),this.isPlayerDisabled=!1,this.tilemap=this.make.tilemap({key:"mapL2"});var n=this.tilemap.addTilesetImage("industrial.v2","tiles");this.tilemap.createDynamicLayer("background",n),this.obstacles=this.tilemap.createDynamicLayer("obstacles",n),this.tilemap.createDynamicLayer("foreground",n).setDepth(10),this.createUI(),this.createSpikes(),this.createPlayer(),this.createGun(),this.createReflectors(),this.createLever(),this.createJumper(),this.createSphere(),this.obstacles.setCollisionByProperty({collides:!0}),this.physics.world.addCollider(this.player.sprite,this.obstacles),this.physics.world.addCollider(this.bullets,this.obstacles,(function(e){e.destroy()})),this.cameras.main.startFollow(this.player.sprite,!0,.1,.1),this.cameras.main.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels),this.soundManager.playBGMusic()}},{key:"getPoint",value:function(e,t){return this.tilemap.findObject(e,(function(e){return e.name===t}))}},{key:"getPoints",value:function(e,t){var n=this;return t.map((function(t){return n.getPoint(e,t)}))}},{key:"createUI",value:function(){var e=this,t=this.soundManager,n=t.bgMusicMuted,r=t.sfxMuted;new C({scene:this,texture:"button_music",x:this.cameras.main.width-32,y:32,switchedOn:!n,onSwitchOn:function(){e.soundManager.unmuteBGMusic()},onSwitchOff:function(){e.soundManager.muteBGMusic()}}),new C({scene:this,texture:"button_sfx",x:this.cameras.main.width-32,y:74,switchedOn:!r,onSwitchOn:function(){e.soundManager.unmuteSFX()},onSwitchOff:function(){e.soundManager.muteSFX()}})}},{key:"createSpikes",value:function(){var e=this;this.spikes=this.physics.add.staticGroup(),this.obstacles.forEachTile((function(t){if(77===t.index){var n=e.spikes.create(t.getCenterX(),t.getCenterY(),"spike");n.rotation=t.rotation,0===n.angle?n.body.setSize(32,6).setOffset(0,26):-90===n.angle?n.body.setSize(6,32).setOffset(26,0):90===n.angle?n.body.setSize(6,32).setOffset(0,0):-180===n.angle&&n.body.setSize(32,6).setOffset(0,0),e.obstacles.removeTileAt(t.x,t.y)}}))}},{key:"createPlayer",value:function(){var e=this.getPoint("points","spawn"),t=e.x,n=e.y;this.player=new ie({scene:this,x:t,y:n,soundManager:this.soundManager})}},{key:"createGun",value:function(){this.bullets=this.add.group();var e=this.getPoint("points","gun"),t=e.x,n=e.y;this.gun=new ft({scene:this,x:t,y:n,group:this.bullets,dir:"right",soundManager:this.soundManager})}},{key:"createReflectors",value:function(){var e=this;this.reflectors=this.physics.add.group({allowGravity:!1}),this.getPoints("points",["reflector_top","reflector_bottom"]).forEach((function(t){var n=t.x,r=t.y;return e.reflectors.add(new wt({scene:e,x:n,y:r,soundManager:e.soundManager}))}))}},{key:"createLever",value:function(){var e=this,t=this.getPoint("points","lever"),n=t.x,r=t.y,i=this.getPoint("points","removable");this.lever=new Oe({scene:this,x:n,y:r,soundManager:this.soundManager,onSwitchOn:function(){e.obstacles.removeTileAtWorldXY(i.x,i.y)},onSwitchOff:function(){e.obstacles.putTileAtWorldXY(14,i.x,i.y).setCollision(!0)}})}},{key:"createJumper",value:function(){var e=this.getPoint("points","jumper"),t=e.x,n=e.y;this.jumper=new Ze({scene:this,x:t,y:n,tile:this.obstacles.getTileAtWorldXY(t,n),soundManager:this.soundManager})}},{key:"createSphere",value:function(){var e=this.getPoint("points","sphere"),t=e.x,n=e.y;this.sphere=new pe({scene:this,x:t,y:n,onEnter:this.nextLevel})}},{key:"checkGunOverlap",value:function(){this.physics.world.overlap(this.gun,this.player.flash,(function(e){e.shoot()}))}},{key:"checkReflectorsOverlap",value:function(){this.physics.world.overlap(this.reflectors,this.player.flash,(function(e,t){t.switch()}))}},{key:"checkBulletReflectorOverlap",value:function(){this.physics.world.overlap(this.bullets,this.reflectors,(function(e,t){var n=Date.now(),r=e,i=t;if(!(n<i.lastCollisionTime+100)){var o=i.angle;switch(r.dir){case"right":if(![-90,-180].includes(o)){e.destroy();break}r.dir=-180===o?"down":"up",r.x=i.x-r.width/2,r.body.setVelocity(0,-180===o?500:-500),i.collide();break;case"left":if(![0,90].includes(o)){r.destroy();break}r.dir=90===o?"down":"up",r.x=i.x+r.width/2,r.body.setVelocity(0,90===o?500:-500),i.collide();break;case"up":if(![90,-180].includes(o)){r.destroy();break}r.dir=-180===o?"left":"right",r.x=i.x,r.y=i.y+r.height/2,r.body.setVelocity(-180===o?-500:500,0),i.collide();break;case"down":if(![0,-90].includes(o)){r.destroy();break}r.dir=-90===o?"left":"right",r.x=i.x,r.y=i.y-r.height/2,r.body.setVelocity(-90===o?-500:500,0),i.collide();break;default:r.destroy()}i.lastCollisionTime=n}}))}},{key:"checkLeversOverlap",value:function(){this.physics.world.overlap(this.lever,this.bullets,(function(e){e.switch()}))}},{key:"checkJumpersOverlap",value:function(){this.physics.world.overlap(this.jumper,this.player.sprite,(function(e,t){e.switch(),t.setVelocityY(-1e3)}))}},{key:"checkSphereOverlap",value:function(){this.physics.world.overlap(this.sphere,this.player.sprite,(function(e){e.activate()}))}},{key:"checkGameOver",value:function(){return this.physics.world.overlap(this.player.sprite,this.spikes)}},{key:"restart",value:function(){var e=this;this.isPlayerDisabled=!0;var t=this.cameras.main;t.shake(100,.05),t.fade(250,0,0,0),this.player.freeze(),this.soundManager.stopBGMusic(),this.soundManager.die(),t.once("camerafadeoutcomplete",(function(){e.player.destroy(),e.scene.restart()}))}},{key:"update",value:function(){this.isPlayerDisabled||(this.player.update(),this.checkGunOverlap(),this.checkReflectorsOverlap(),this.checkBulletReflectorOverlap(),this.checkLeversOverlap(),this.checkJumpersOverlap(),this.checkSphereOverlap(),this.checkGameOver()&&this.restart())}}])&&St(t.prototype,n),r&&St(t,r),o}(i.a.Scene);function Mt(e){return(Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dt(e,t){return(Dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ct(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Gt(e);if(t){var i=Gt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return It(this,n)}}function It(e,t){return!t||"object"!==Mt(t)&&"function"!=typeof t?At(e):t}function At(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gt(e){return(Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Nt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dt(e,t)}(o,e);var t,n,r,i=Ct(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Lt(At(t=i.call(this,e.scene,e.x,e.y,"bat",0)),"props",void 0),Lt(At(t),"hazardType","common"),t.props=e,t.createAnimations(),t.init(),t}return t=o,(n=[{key:"createAnimations",value:function(){var e=this.scene.anims;e.create({key:"bat-fly",frames:e.generateFrameNumbers("bat",{start:0,end:4}),frameRate:8,repeat:-1})}},{key:"init",value:function(){this.setScale(1.5),this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0),this.play("bat-fly")}},{key:"follow",value:function(){var e=this,t=this.props,n=t.start,r=t.end,i=t.followDuration,o=void 0===i?2e3:i,s=r.x<n.x;this.setFlipX(s),this.scene.tweens.add({targets:this,x:r.x,y:r.y,ease:"Sine",duration:o,onComplete:function(){e.setFlipX(!s),e.scene.tweens.add({targets:e,x:n.x,y:n.y,ease:"Sine",duration:o,onComplete:function(){e.follow()}})}})}},{key:"die",value:function(){this.anims.stop(),this.body.setMaxVelocity(0,1e3),this.body.setVelocityY(300)}}])&&Rt(t.prototype,n),r&&Rt(t,r),o}(i.a.GameObjects.Sprite);function Bt(e){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ht(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ht(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zt(e,t){return(zt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Kt(e);if(t){var i=Kt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Vt(this,n)}}function Vt(e,t){return!t||"object"!==Bt(t)&&"function"!=typeof t?Wt(e):t}function Wt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kt(e){return(Kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Jt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zt(e,t)}(o,e);var t,n,r,i=Xt(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Yt(Wt(e=i.call(this,"L3")),"timer",void 0),Yt(Wt(e),"soundManager",void 0),Yt(Wt(e),"player",void 0),Yt(Wt(e),"isPlayerDisabled",void 0),Yt(Wt(e),"tilemap",void 0),Yt(Wt(e),"obstacles",void 0),Yt(Wt(e),"spikes",void 0),Yt(Wt(e),"jumpers",void 0),Yt(Wt(e),"hazards",void 0),Yt(Wt(e),"platforms",[]),Yt(Wt(e),"sphere",void 0),Yt(Wt(e),"jumper",void 0),Yt(Wt(e),"lever",void 0),Yt(Wt(e),"nextLevel",(function(){e.isPlayerDisabled=!0;var t=e.cameras.main;t.zoomTo(2,1e3),e.player.freeze(),e.timer.remove(),e.platforms=[],e.soundManager.stopBGMusic(),e.soundManager.sphere(),t.once("camerazoomcomplete",(function(){t.fade(1e3,29,33,45)})),t.once("camerafadeoutcomplete",(function(){e.player.destroy(),e.scene.restart()}))})),e}return t=o,(n=[{key:"create",value:function(e){var t=this,n=e.volumeConfig;this.soundManager=new Ce({volumeConfig:n,manager:this.sound}),this.isPlayerDisabled=!1,this.tilemap=this.make.tilemap({key:"mapL3"});var r=this.tilemap.addTilesetImage("industrial.v2","tiles");this.tilemap.createDynamicLayer("background",r),this.obstacles=this.tilemap.createDynamicLayer("obstacles",r),this.tilemap.createDynamicLayer("foreground",r).setDepth(10),this.createUI(),this.createSpikes(),this.createPlayer(),this.createHidingPlatform(),this.createJumpers(),this.createHazards(),this.createSphere(),this.obstacles.setCollisionByProperty({collides:!0}),this.physics.world.addCollider(this.player.sprite,this.obstacles),this.cameras.main.startFollow(this.player.sprite,!0,.1,.1),this.cameras.main.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels),setTimeout((function(){t.timer=t.time.addEvent({delay:3e3,callback:function(){t.platforms.forEach((function(e,t){setTimeout((function(){null==e||e.switch()}),100*t)}))},callbackScope:t,loop:!0})}),100),this.soundManager.playBGMusic()}},{key:"getPoint",value:function(e,t){return this.tilemap.findObject(e,(function(e){return e.name===t}))}},{key:"getPoints",value:function(e,t){var n=this;return t.map((function(t){return n.getPoint(e,t)}))}},{key:"createUI",value:function(){var e=this,t=this.soundManager,n=t.bgMusicMuted,r=t.sfxMuted;new C({scene:this,texture:"button_music",x:this.cameras.main.width-32,y:32,switchedOn:!n,onSwitchOn:function(){e.soundManager.unmuteBGMusic()},onSwitchOff:function(){e.soundManager.muteBGMusic()}}),new C({scene:this,texture:"button_sfx",x:this.cameras.main.width-32,y:74,switchedOn:!r,onSwitchOn:function(){e.soundManager.unmuteSFX()},onSwitchOff:function(){e.soundManager.muteSFX()}})}},{key:"createSpikes",value:function(){var e=this;this.spikes=this.physics.add.staticGroup(),this.obstacles.forEachTile((function(t){if(77===t.index){var n=e.spikes.create(t.getCenterX(),t.getCenterY(),"spike");n.rotation=t.rotation,0===n.angle?n.body.setSize(32,6).setOffset(0,26):-90===n.angle?n.body.setSize(6,32).setOffset(26,0):90===n.angle?n.body.setSize(6,32).setOffset(0,0):-180===n.angle&&n.body.setSize(32,6).setOffset(0,0),e.obstacles.removeTileAt(t.x,t.y)}}))}},{key:"createPlayer",value:function(){var e=this.getPoint("points","spawn"),t=e.x,n=e.y;this.player=new ie({scene:this,x:t,y:n,soundManager:this.soundManager})}},{key:"createHidingPlatform",value:function(){var e=this;this.getPoints("platforms",["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"]).forEach((function(t){var n=t.x,r=t.y,i=new Me({scene:e,x:n,y:r,tilemap:e.obstacles});e.platforms.push(i)}))}},{key:"createJumpers",value:function(){var e=this;this.jumpers=this.physics.add.group({allowGravity:!1}),this.getPoints("points",["jumper1","jumper2","jumper3","jumper4"]).forEach((function(t,n){var r=t.x,i=t.y,o=new Ze({scene:e,x:r,y:i,tile:e.obstacles.getTileAtWorldXY(r,i),id:"jumper_".concat(n+1),soundManager:e.soundManager});e.jumpers.add(o)}))}},{key:"createHazards",value:function(){this.hazards=this.physics.add.group({allowGravity:!1});var e=Ft(this.getPoints("points",["h1_start","h1_end"]),2),t=e[0],n=e[1],r=new Nt({scene:this,x:t.x,y:t.y,start:t,end:n});r.follow(),this.hazards.add(r);var i=Ft(this.getPoints("points",["h2_start","h2_end"]),2),o=i[0],s=i[1],a=new Nt({scene:this,x:o.x,y:o.y,start:o,end:s});a.follow(),this.hazards.add(a)}},{key:"createSphere",value:function(){var e=this.getPoint("points","sphere"),t=e.x,n=e.y;this.sphere=new pe({scene:this,x:t,y:n,onEnter:this.nextLevel})}},{key:"checkJumpersOverlap",value:function(){this.physics.world.overlap(this.jumpers,this.player.sprite,(function(e,t){var n=t,r=e;switch(n.switch(),r.setVelocityY(-650),n.id){case"jumper_1":n.switch(),r.setVelocityY(-650);break;default:n.switch(),r.setVelocityY(-550)}}))}},{key:"checkSphereOverlap",value:function(){this.physics.world.overlap(this.sphere,this.player.sprite,(function(e){e.activate()}))}},{key:"checkGameOver",value:function(){return this.physics.world.overlap(this.player.sprite,this.spikes)||this.physics.world.overlap(this.player.sprite,this.hazards)}},{key:"restart",value:function(){var e=this;this.isPlayerDisabled=!0;var t=this.cameras.main;t.shake(100,.05),t.fade(250,0,0,0),this.player.freeze(),this.timer.remove(),this.platforms=[],this.soundManager.stopBGMusic(),this.soundManager.die(),t.once("camerafadeoutcomplete",(function(){e.player.destroy(),e.scene.restart()}))}},{key:"update",value:function(){this.isPlayerDisabled||(this.player.update(),this.checkJumpersOverlap(),this.checkSphereOverlap(),this.checkGameOver()&&this.restart())}}])&&Ut(t.prototype,n),r&&Ut(t,r),o}(i.a.Scene);function $t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$t(Object(n),!0).forEach((function(t){Qt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(1755);var Zt,en=(Zt=[P,Xe,Tt,Jt],qt(qt({},{width:736,height:416}),{},{scene:Zt,type:i.a.AUTO,scale:{mode:i.a.Scale.FIT,autoCenter:i.a.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{debug:!1,gravity:{y:1e3}}},parent:document.getElementById("app"),backgroundColor:"#1d212d",pixelArt:!0,callbacks:{preBoot:function(e){e.device.input.touch&&document.body.classList.add("touch")}}}));new i.a.Game(en)},667:function(e,t,n){n(668),e.exports=n(1756)}});