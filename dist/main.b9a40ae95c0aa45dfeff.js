!function(e){function t(t){for(var r,s,a=t[0],c=t[1],u=t[2],f=0,h=[];f<a.length;f++)s=a[f],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&h.push(i[s][0]),i[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(t);h.length;)h.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,a=1;a<n.length;a++){var c=n[a];0!==i[c]&&(r=!1)}r&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},i={0:0},o=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var a=window.webpackJsonp=window.webpackJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=c;o.push([669,1]),n()}({1757:function(e,t,n){},1758:function(e,t,n){"use strict";n.r(t);var r=n(5),i=n.n(r);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(n,Phaser.Renderer.WebGL.Pipelines.TextureTintPipeline);var t=a(n);function n(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this,{game:e,renderer:e.renderer,fragShader:"\n            precision mediump float;\n\n            uniform float time;\n            uniform sampler2D uMainSampler;\n            varying vec2 outTexCoord;\n\n            void main(void) {\n                vec4 color = texture2D(uMainSampler, outTexCoord);\n                if (color.a != 0.0) {\n                    gl_FragColor = mix(color, vec4(1.0), cos(time / 50.0));\n                }\n            }"})}return n}();function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g(e);if(t){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v(this,n)}}function v(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w="../assets",O={SPRITESHEET:"".concat(w,"/spritesheets"),IMAGES:"".concat(w,"/images"),TILESETS:"".concat(w,"/tilesets"),TILEMAPS:"".concat(w,"/tilemaps"),SOUNDS:"".concat(w,"/sounds")},S={frameWidth:32,frameHeight:32},P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(o,e);var t,n,r,i=b(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"Boot")}return t=o,(n=[{key:"preload",value:function(){var e=this.cameras.main.width,t=this.cameras.main.height,n=this.add.graphics(),r=this.add.graphics();r.fillStyle(3094089,.8),r.fillRect(e/2-160-10,t/2-30,320,50),this.make.text({x:e/2,y:t/2-50,text:"Loading...",style:{font:"20px monospace",fill:"#ffffff"}}).setOrigin(.5,.5);var i=this.make.text({x:e/2,y:t/2-5,text:"0%",style:{font:"18px monospace",fill:"#ffffff"}});i.setOrigin(.5,.5),this.load.on("progress",(function(r){n.clear(),n.fillStyle(16777215,1),n.fillRect(e/2-160,t/2-20,300*r,30),i.setText(parseInt(String(100*r),10)+"%")})),this.load.spritesheet("player","".concat(O.SPRITESHEET,"/player.png"),p(p({},S),{},{margin:1,spacing:2})),this.load.spritesheet("player_flash","".concat(O.SPRITESHEET,"/player_flash.png"),{frameWidth:48,frameHeight:32}),this.load.spritesheet("gun_bullet","".concat(O.SPRITESHEET,"/gun_bullet.png"),{frameWidth:10,frameHeight:10}),this.load.spritesheet("sphere","".concat(O.SPRITESHEET,"/sphere.png"),S),this.load.spritesheet("gun","".concat(O.SPRITESHEET,"/gun.png"),S),this.load.spritesheet("button","".concat(O.SPRITESHEET,"/button.png"),S),this.load.spritesheet("lever","".concat(O.SPRITESHEET,"/lever.png"),S),this.load.spritesheet("hiding_platform","".concat(O.SPRITESHEET,"/hiding_platform.png"),S),this.load.spritesheet("reflector","".concat(O.SPRITESHEET,"/reflector.png"),S),this.load.spritesheet("glorg","".concat(O.SPRITESHEET,"/glorg.png"),S),this.load.spritesheet("charger","".concat(O.SPRITESHEET,"/charger.png"),S),this.load.spritesheet("robot1","".concat(O.SPRITESHEET,"/robot1.png"),S),this.load.spritesheet("bat","".concat(O.SPRITESHEET,"/bat.png"),{frameWidth:16,frameHeight:16}),this.load.spritesheet("button_music","".concat(O.SPRITESHEET,"/button_music.png"),S),this.load.spritesheet("button_sfx","".concat(O.SPRITESHEET,"/button_sfx.png"),S),this.load.spritesheet("button_left","".concat(O.SPRITESHEET,"/button_left.png"),{frameWidth:64,frameHeight:64}),this.load.spritesheet("button_right","".concat(O.SPRITESHEET,"/button_right.png"),{frameWidth:64,frameHeight:64}),this.load.spritesheet("button_up","".concat(O.SPRITESHEET,"/button_up.png"),{frameWidth:64,frameHeight:64}),this.load.spritesheet("button_hit","".concat(O.SPRITESHEET,"/button_hit.png"),{frameWidth:64,frameHeight:64}),this.load.image("spike","".concat(O.IMAGES,"/spike.png")),this.load.image("jumper_opened","".concat(O.IMAGES,"/jumper_opened.png")),this.load.image("tiles","".concat(O.TILESETS,"/industrial.png")),this.load.tilemapTiledJSON("mapL1","".concat(O.TILEMAPS,"/warehouse_v2_L1.json")),this.load.tilemapTiledJSON("mapL2","".concat(O.TILEMAPS,"/warehouse_v2_L2.json")),this.load.tilemapTiledJSON("mapL3","".concat(O.TILEMAPS,"/warehouse_v2_L3.json")),this.load.audio("bg_1",["".concat(O.SOUNDS,"/background/bg_1.ogg"),"".concat(O.SOUNDS,"/background/bg_1.mp3")]),this.load.audio("die",["".concat(O.SOUNDS,"/player/die.ogg"),"".concat(O.SOUNDS,"/player/die.mp3")]),this.load.audio("jump",["".concat(O.SOUNDS,"/player/jump.ogg"),"".concat(O.SOUNDS,"/player/jump.mp3")]),this.load.audio("land",["".concat(O.SOUNDS,"/player/land.ogg"),"".concat(O.SOUNDS,"/player/land.mp3")]),this.load.audio("hit",["".concat(O.SOUNDS,"/player/hit.ogg"),"".concat(O.SOUNDS,"/player/hit.mp3")]),this.load.audio("step",["".concat(O.SOUNDS,"/player/step.ogg"),"".concat(O.SOUNDS,"/player/step.mp3")]),this.load.audio("sphere",["".concat(O.SOUNDS,"/environment/sphere.ogg"),"".concat(O.SOUNDS,"/environment/sphere.mp3")]),this.load.audio("gun",["".concat(O.SOUNDS,"/environment/gun.ogg"),"".concat(O.SOUNDS,"/environment/gun.mp3")]),this.load.audio("lever",["".concat(O.SOUNDS,"/environment/lever.ogg"),"".concat(O.SOUNDS,"/environment/lever.mp3")]),this.load.audio("jumper",["".concat(O.SOUNDS,"/environment/jumper.ogg"),"".concat(O.SOUNDS,"/environment/jumper.mp3")]),this.load.audio("reflector",["".concat(O.SOUNDS,"/environment/reflector.ogg"),"".concat(O.SOUNDS,"/environment/reflector.mp3")]),this.load.audio("reflector_collide",["".concat(O.SOUNDS,"/environment/reflector_collide.ogg"),"".concat(O.SOUNDS,"/environment/reflector_collide.mp3")])}},{key:"addPipelines",value:function(){this.game.renderer.addPipeline("blink",new l(this.game))}},{key:"create",value:function(){this.addPipelines(),this.scene.start("L1")}}])&&d(t.prototype,n),r&&d(t,r),o}(i.a.Scene);function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M(e);if(t){var i=M(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return E(this,n)}}function E(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?T(e):t}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D,C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(s,e);var t,n,r,o=_(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),R(T(t=o.call(this,e.scene,e.x,e.y,e.texture,0)),"props",void 0),R(T(t),"switchedOn",void 0),R(T(t),"lastSwitchTime",Date.now()),t.props=e,t.init(),t}return t=s,(n=[{key:"init",value:function(){var e=this.props.switchedOn,t=void 0===e||e;this.switchedOn=t,this.switchedOn||this.setFrame(1),this.scene.add.existing(this),this.setScrollFactor(0),this.setInteractive(),this.on(i.a.Input.Events.POINTER_DOWN,this.switch)}},{key:"switchOn",value:function(){this.setFrame(0),this.props.onSwitchOn(),this.switchedOn=!0}},{key:"switchOff",value:function(){var e,t;this.setFrame(1),null===(e=(t=this.props).onSwitchOff)||void 0===e||e.call(t),this.switchedOn=!1}},{key:"switch",value:function(){this.switchedOn?this.switchOff():this.switchOn()}}])&&j(t.prototype,n),r&&j(t,r),s}(i.a.GameObjects.Sprite),I=n(668);function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var G="step",L="jump",N="land",B="hit",F="die",H="jumper",U="gun",z="reflector",X="reflector_collide",V="lever",K="sphere",W=(A(D={bg_1:.2},G,.5),A(D,L,.4),A(D,N,.4),A(D,B,.3),A(D,F,.5),A(D,H,.4),A(D,U,.5),A(D,z,.5),A(D,X,.5),A(D,V,.5),A(D,K,.5),D);function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ee(e);if(t){var i=ee(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Q(this,n)}}function Q(e,t){return!t||"object"!==J(t)&&"function"!=typeof t?Z(e):t}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(s,e);var t,n,r,o=q(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),te(Z(t=o.call(this,e.scene,e.x,e.y,"button_".concat(e.type),0)),"props",void 0),te(Z(t),"pressed",!1),t.props=e,t.init(),t}return t=s,(n=[{key:"init",value:function(){this.setScrollFactor(0).setInteractive().setAlpha(.25).on(i.a.Input.Events.POINTER_DOWN,this.switchOn).on(i.a.Input.Events.POINTER_OVER,this.switchOn).on(i.a.Input.Events.POINTER_UP,this.switchOff).on(i.a.Input.Events.POINTER_OUT,this.switchOff),this.scene.add.existing(this)}},{key:"switchOn",value:function(){var e,t;this.pressed||(this.setFrame(1),this.setAlpha(.5),this.pressed=!0,null===(e=(t=this.props).onSwitchOn)||void 0===e||e.call(t))}},{key:"switchOff",value:function(){var e,t;this.pressed&&(this.setFrame(0),this.setAlpha(.25),this.pressed=!1,null===(e=(t=this.props).onSwitchOff)||void 0===e||e.call(t))}}])&&Y(t.prototype,n),r&&Y(t,r),s}(i.a.GameObjects.Sprite);function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var oe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ie(this,"scene",void 0),ie(this,"soundManager",void 0),ie(this,"sprite",void 0),ie(this,"flash",void 0),ie(this,"keys",void 0),ie(this,"leftBtn",null),ie(this,"rightBtn",null),ie(this,"upBtn",null),ie(this,"flashBtn",null),ie(this,"joystick",null),ie(this,"flashBtnPressed",!1),ie(this,"lastFlashTime",Date.now()),ie(this,"inJump",!1),this.scene=t.scene,this.soundManager=t.soundManager,this.createAnimations(),this.createKeys(),this.createSprite(t.x,t.y),this.scene.input.addPointer(4),console.log("#3"),this.scene.sys.game.device.input.touch&&(this.leftBtn=new ne({scene:this.scene,x:48,y:this.scene.cameras.main.height-16-32,type:"left"}),this.rightBtn=new ne({scene:this.scene,x:118,y:this.scene.cameras.main.height-16-32,type:"right"}),this.flashBtn=new ne({scene:this.scene,x:this.scene.cameras.main.width-16-32,y:this.scene.cameras.main.height-16-32,type:"hit"}),this.upBtn=new ne({scene:this.scene,x:this.scene.cameras.main.width-16-32,y:this.scene.cameras.main.height-16-32-64-10,type:"up"}))}var t,n,r;return t=e,(n=[{key:"createAnimations",value:function(){var e=this.scene.anims;e.create({key:"player-idle",frames:e.generateFrameNumbers("player",{start:0,end:3}),frameRate:4,repeat:-1}),e.create({key:"player-run",frames:e.generateFrameNumbers("player",{start:8,end:15}),frameRate:12,repeat:-1}),e.create({key:"player-land",frames:e.generateFrameNumbers("player",{start:4,end:7}),frameRate:12}),e.create({key:"player-hit",frames:e.generateFrameNumbers("player",{start:24,end:27}),frameRate:14}),e.create({key:"player-flash",frames:e.generateFrameNumbers("player_flash",{start:0,end:3}),frameRate:14,hideOnComplete:!0})}},{key:"createKeys",value:function(){var e=i.a.Input.Keyboard.KeyCodes,t=e.SPACE,n=e.LEFT,r=e.RIGHT,o=e.UP,s=e.W,a=e.A,c=e.D;this.keys=this.scene.input.keyboard.addKeys({space:t,left:n,right:r,up:o,w:s,a:a,d:c})}},{key:"createSprite",value:function(e,t){this.sprite=this.scene.physics.add.sprite(e,t,"player",0).setDrag(1e3,0).setMaxVelocity(200,1e3).setSize(18,24).setOffset(7,9).setDepth(2)}},{key:"createFlash",value:function(){var e=this;this.flash=this.scene.add.sprite(this.sprite.x,this.sprite.y,"player_flash",0).setFlipX(this.sprite.flipX).play("player-flash",!0).on(i.a.Animations.Events.SPRITE_ANIMATION_COMPLETE,(function(){e.flash.destroy()})),this.flash.x+=this.sprite.flipX?-this.flash.width/2-this.sprite.width/2:this.flash.width/2+this.sprite.width/2,this.scene.physics.add.existing(this.flash),this.flash.body.enable=!1,this.flash.body.setMaxVelocity(0,0).setSize(48,32),setTimeout((function(){e.flash.body.enable=!0}),0)}},{key:"createJoystick",value:function(){this.joystick=new I.a(this.scene,{x:82,y:334,radius:50,base:this.scene.add.circle(0,0,50,5068642,.5).setDepth(20),thumb:this.scene.add.circle(0,0,25,16777215,.25).setDepth(20),dir:"8dir"})}},{key:"hit",value:function(){var e,t;(null===(e=this.flash)||void 0===e||null===(t=e.anims)||void 0===t?void 0:t.isPlaying)||(this.createFlash(),this.soundManager.hit())}},{key:"freeze",value:function(){this.sprite.body.moves=!1}},{key:"update",value:function(){var e,t,n,r,i,o,s=this.keys,a=this.sprite,c=a.body.blocked.down,u=c?400:200,l=Date.now(),f=s.left.isDown||s.a.isDown||(null===(e=this.leftBtn)||void 0===e?void 0:e.pressed),h=s.right.isDown||s.d.isDown||(null===(t=this.rightBtn)||void 0===t?void 0:t.pressed),p=s.up.isDown||s.w.isDown||(null===(n=this.upBtn)||void 0===n?void 0:n.pressed);f?(a.setAccelerationX(-u),a.setFlipX(!0),c&&!a.body.blocked.left&&this.soundManager.step()):h?(a.setAccelerationX(u),a.setFlipX(!1),c&&!a.body.blocked.right&&this.soundManager.step()):a.setAccelerationX(0),c&&p&&(this.soundManager.jump(),a.setVelocityY(-400)),(s.space.isDown||(null===(r=this.flashBtn)||void 0===r?void 0:r.pressed))&&l-this.lastFlashTime>=500&&(a.anims.play("player-hit",!0),this.lastFlashTime=l,this.hit()),a.anims.isPlaying&&"player-hit"===(null===(i=a.anims.currentAnim)||void 0===i?void 0:i.key)||(a.body.deltaY()>.3&&c&&(a.anims.play("player-land",!0),this.soundManager.land()),a.anims.isPlaying&&"player-land"===(null===(o=a.anims.currentAnim)||void 0===o?void 0:o.key)||(c&&0===a.body.velocity.x?a.anims.play("player-idle",!0):c?a.anims.play("player-run",!0):(a.anims.stop(),a.setTexture("player",10))))}},{key:"destroy",value:function(){this.sprite.destroy()}}])&&re(t.prototype,n),r&&re(t,r),e}();function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ce(e,t){return(ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=he(e);if(t){var i=he(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return le(this,n)}}function le(e,t){return!t||"object"!==se(t)&&"function"!=typeof t?fe(e):t}function fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function he(e){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ce(e,t)}(o,e);var t,n,r,i=ue(o);function o(e){var t,n,r,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),t=i.call(this,e.scene,e.x,e.y,"sphere",6),n=fe(t),s=void 0,(r="props")in n?Object.defineProperty(n,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[r]=s,t.props=e,t.init(),t}return t=o,(n=[{key:"init",value:function(){this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0)}},{key:"activate",value:function(){this.props.onEnter()}}])&&ae(t.prototype,n),r&&ae(t,r),o}(i.a.GameObjects.Sprite);function ye(e){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function me(e,t){return(me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=we(e);if(t){var i=we(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ve(this,n)}}function ve(e,t){return!t||"object"!==ye(t)&&"function"!=typeof t?ge(e):t}function ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(o,e);var t,n,r,i=be(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Oe(ge(t=i.call(this,e.scene,e.x,e.y,"lever",0)),"props",void 0),Oe(ge(t),"lastSwitchTime",Date.now()),Oe(ge(t),"switchedOn",!1),t.props=e,t.init(),t}return t=o,(n=[{key:"init",value:function(){this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0),this.body.setSize(24,20),this.body.setOffset(6,12)}},{key:"blink",value:function(){var e=this;this.setPipeline("blink"),setTimeout((function(){return e.resetPipeline()}),50)}},{key:"checkSwitchAccessibility",value:function(){var e=Date.now();return!(e-this.lastSwitchTime<500||(this.lastSwitchTime=e,0))}},{key:"switchOn",value:function(){this.setFrame(4),this.props.onSwitchOn(),this.switchedOn=!0}},{key:"switchOff",value:function(){var e,t;this.setFrame(0),null===(e=(t=this.props).onSwitchOff)||void 0===e||e.call(t),this.switchedOn=!1}},{key:"switch",value:function(){this.checkSwitchAccessibility()&&(this.switchedOn?this.switchOff():this.switchOn(),this.blink(),this.props.soundManager.lever())}}])&&de(t.prototype,n),r&&de(t,r),o}(i.a.GameObjects.Sprite);function Pe(e){return(Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function je(e,t){return(je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Te(e);if(t){var i=Te(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _e(this,n)}}function _e(e,t){return!t||"object"!==Pe(t)&&"function"!=typeof t?Ee(e):t}function Ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Te(e){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)}(s,e);var t,n,r,o=xe(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),Me(Ee(t=o.call(this,e.scene,e.x,e.y,"hiding_platform",3)),"props",void 0),Me(Ee(t),"lastSwitchTime",Date.now()),Me(Ee(t),"shown",void 0),t.props=e,t.createAnimations(),t.init(),t}return t=s,(n=[{key:"createAnimations",value:function(){this.scene.anims.create({key:"platform-hide",frames:this.scene.anims.generateFrameNumbers("hiding_platform",{start:0,end:3}),frameRate:12}),this.scene.anims.create({key:"platform-show",frames:this.scene.anims.generateFrameNumbers("hiding_platform",{start:3,end:0}),frameRate:12})}},{key:"init",value:function(){var e=this.props.initialVisibility,t=void 0!==e&&e;this.shown=t,this.scene.add.existing(this)}},{key:"switch",value:function(){var e=this,t=Date.now();if(this.scene&&!(t-this.lastSwitchTime<500)){var n=this.shown?"platform-hide":"platform-show";this.lastSwitchTime=t,this.shown=!this.shown,this.shown||this.props.tilemap.removeTileAtWorldXY(this.x,this.y),this.play(n),this.on(i.a.Animations.Events.SPRITE_ANIMATION_COMPLETE,(function(){e.shown&&e.props.tilemap.putTileAtWorldXY(353,e.x,e.y).setCollision(!0)}))}}}])&&ke(t.prototype,n),r&&ke(t,r),s}(i.a.GameObjects.Sprite);function De(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ie=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ce(this,"manager",void 0),Ce(this,"bgKey","bg_1"),Ce(this,"volumeConfig",void 0),Ce(this,"lastStepTime",Date.now()),Ce(this,"bgMusicMuted",void 0),Ce(this,"sfxMuted",void 0),this.manager=t.manager,this.volumeConfig=t.volumeConfig,this.bgMusicMuted=0===this.volumeConfig[this.bgKey],this.sfxMuted=0===this.volumeConfig[L]}var t,n,r;return t=e,(n=[{key:"playBGMusic",value:function(){var e=this.manager.get(this.bgKey);e?e.play():this.manager.play(this.bgKey,{volume:.2,loop:!0})}},{key:"muteBGMusic",value:function(){this.manager.get(this.bgKey).volume=0,this.volumeConfig[this.bgKey]=0,this.bgMusicMuted=!0}},{key:"unmuteBGMusic",value:function(){var e=this.manager.get(this.bgKey);e.volume=W[this.bgKey],this.volumeConfig[this.bgKey]=W[this.bgKey],this.bgMusicMuted=!1,e.isPlaying||e.play()}},{key:"stopBGMusic",value:function(){this.manager.stopByKey(this.bgKey)}},{key:"step",value:function(){var e,t=G,n=Date.now();(null===(e=this.manager.get(G))||void 0===e?void 0:e.isPlaying)||n-this.lastStepTime<300||(this.lastStepTime=n,this.manager.play(t,{volume:this.volumeConfig[t]}))}},{key:"jump",value:function(){var e=L;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"land",value:function(){var e=N;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"hit",value:function(){var e=B;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"die",value:function(){var e=F;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"jumper",value:function(){var e=H;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"gun",value:function(){var e=U;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"reflector",value:function(){var e=z;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"reflectorCollide",value:function(){var e=X;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"lever",value:function(){var e=V;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"sphere",value:function(){var e=K;this.manager.play(e,{volume:this.volumeConfig[e]})}},{key:"muteSFX",value:function(){var e=this;Object.keys(this.volumeConfig).forEach((function(t){t!==e.bgKey&&(e.volumeConfig[t]=0)})),this.sfxMuted=!0}},{key:"unmuteSFX",value:function(){var e=this;Object.keys(this.volumeConfig).forEach((function(t){t!==e.bgKey&&(e.volumeConfig[t]=W[t])})),this.sfxMuted=!1}}])&&De(t.prototype,n),r&&De(t,r),e}();function Ae(e){return(Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(n),!0).forEach((function(t){Xe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Be(e,t){return(Be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ze(e);if(t){var i=ze(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return He(this,n)}}function He(e,t){return!t||"object"!==Ae(t)&&"function"!=typeof t?Ue(e):t}function Ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Be(e,t)}(o,e);var t,n,r,i=Fe(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Xe(Ue(e=i.call(this,"L1")),"player",void 0),Xe(Ue(e),"soundManager",void 0),Xe(Ue(e),"isPlayerDisabled",void 0),Xe(Ue(e),"tilemap",void 0),Xe(Ue(e),"obstacles",void 0),Xe(Ue(e),"sphere",void 0),Xe(Ue(e),"platform",void 0),Xe(Ue(e),"lever",void 0),Xe(Ue(e),"nextLevel",(function(){e.isPlayerDisabled=!0;var t=e.cameras.main;t.zoomTo(2,1e3),e.player.freeze(),e.soundManager.stopBGMusic(),e.soundManager.sphere(),t.once("camerazoomcomplete",(function(){t.fade(1e3,29,33,45)})),t.once("camerafadeoutcomplete",(function(){var t=e.soundManager.volumeConfig;e.player.destroy(),e.scene.start("L2",{volumeConfig:t})}))})),e}return t=o,(n=[{key:"create",value:function(e){var t=e.volumeConfig;this.soundManager=new Ie({manager:this.sound,volumeConfig:t||Le({},W)}),this.isPlayerDisabled=!1,this.add.text(16,16,"Arrow keys or WASD to move & jump\nSpace to hit",{font:"18px monospace",fill:"#000000",padding:{x:20,y:10},backgroundColor:"#ffffff"}).setScrollFactor(0).setDepth(11),this.tilemap=this.make.tilemap({key:"mapL1"});var n=this.tilemap.addTilesetImage("industrial.v2","tiles");this.tilemap.createDynamicLayer("background",n),this.obstacles=this.tilemap.createDynamicLayer("obstacles",n),this.tilemap.createDynamicLayer("foreground",n).setDepth(10),this.createUI(),this.createPlayer(),this.createHidingPlatform(),this.createLever(),this.createSphere(),this.obstacles.setCollisionByProperty({collides:!0}),this.physics.world.addCollider(this.player.sprite,this.obstacles),this.cameras.main.startFollow(this.player.sprite,!0,.1,.1),this.cameras.main.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels),this.soundManager.bgMusicMuted||this.soundManager.playBGMusic()}},{key:"getPoint",value:function(e,t){return this.tilemap.findObject(e,(function(e){return e.name===t}))}},{key:"createUI",value:function(){var e=this,t=this.soundManager,n=t.bgMusicMuted,r=t.sfxMuted;new C({scene:this,texture:"button_music",x:this.cameras.main.width-32,y:32,switchedOn:!n,onSwitchOn:function(){e.soundManager.unmuteBGMusic()},onSwitchOff:function(){e.soundManager.muteBGMusic()}}),new C({scene:this,texture:"button_sfx",x:this.cameras.main.width-32,y:74,switchedOn:!r,onSwitchOn:function(){e.soundManager.unmuteSFX()},onSwitchOff:function(){e.soundManager.muteSFX()}})}},{key:"createPlayer",value:function(){var e=this.getPoint("points","spawn"),t=e.x,n=e.y;this.player=new oe({scene:this,x:t,y:n,soundManager:this.soundManager})}},{key:"createHidingPlatform",value:function(){var e=this.getPoint("points","platform"),t=e.x,n=e.y;this.platform=new Re({scene:this,x:t,y:n,tilemap:this.obstacles})}},{key:"createLever",value:function(){var e=this,t=this.getPoint("points","lever"),n=t.x,r=t.y;this.lever=new Se({scene:this,x:n,y:r,soundManager:this.soundManager,onSwitchOn:function(){e.platform.switch()},onSwitchOff:function(){e.platform.switch()}})}},{key:"createSphere",value:function(){var e=this.getPoint("points","sphere"),t=e.x,n=e.y;this.sphere=new pe({scene:this,x:t,y:n,onEnter:this.nextLevel})}},{key:"checkLeversOverlap",value:function(){this.physics.world.overlap(this.lever,this.player.flash,(function(e){e.switch()}))}},{key:"checkSphereOverlap",value:function(){this.physics.world.overlap(this.sphere,this.player.sprite,(function(e){e.activate()}))}},{key:"checkGameOver",value:function(){return this.player.sprite.y>this.obstacles.height}},{key:"restart",value:function(){var e=this;this.isPlayerDisabled=!0;var t=this.cameras.main;t.shake(100,.05),t.fade(250,0,0,0),this.player.freeze(),this.soundManager.stopBGMusic(),this.soundManager.die(),t.once("camerafadeoutcomplete",(function(){var t=e.soundManager.volumeConfig;e.player.destroy(),e.scene.restart({volumeConfig:t})}))}},{key:"update",value:function(){this.isPlayerDisabled||(this.player.update(),this.checkLeversOverlap(),this.checkSphereOverlap(),this.checkGameOver()&&this.restart())}}])&&Ne(t.prototype,n),r&&Ne(t,r),o}(i.a.Scene);function Ke(e){return(Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Je(e,t){return(Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qe(e);if(t){var i=Qe(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return $e(this,n)}}function $e(e,t){return!t||"object"!==Ke(t)&&"function"!=typeof t?qe(e):t}function qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qe(e){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var et=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Je(e,t)}(o,e);var t,n,r,i=Ye(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Ze(qe(t=i.call(this,e.scene,e.x,e.y,"jumper_opened")),"props",void 0),Ze(qe(t),"id",void 0),Ze(qe(t),"lastSwitchTime",Date.now()),Ze(qe(t),"opened",!1),Ze(qe(t),"toggleView",(function(){t.opened?(t.props.tile.visible=!1,t.visible=!0):(t.props.tile.visible=!0,t.visible=!1)})),t.props=e,t.id=e.id,t.init(),t}return t=o,(n=[{key:"init",value:function(){this.visible=!1,this.y-=16,this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0),this.body.setSize(28,2),this.body.setOffset(2,31),this.scene.add.existing(this)}},{key:"switch",value:function(){var e=this,t=Date.now();t-this.lastSwitchTime<500||(this.opened=!this.opened,this.lastSwitchTime=t,this.toggleView(),setTimeout((function(){e.opened=!e.opened,e.toggleView()}),500),this.props.soundManager.jumper())}}])&&We(t.prototype,n),r&&We(t,r),o}(i.a.GameObjects.Sprite);function tt(e){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function it(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ot(e,t)}function ot(e,t){return(ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function st(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ut(e);if(t){var i=ut(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return at(this,n)}}function at(e,t){return!t||"object"!==tt(t)&&"function"!=typeof t?ct(e):t}function ct(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ut(e){return(ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ft=function(e){it(n,e);var t=st(n);function n(e,r,i,o){var s;return rt(this,n),lt(ct(s=t.call(this,e,i,o,"gun_bullet",0)),"dir",void 0),s.dir=r,s.scene.add.existing(ct(s)),s.scene.physics.add.existing(ct(s)),s.body.setAllowGravity(!1),s.body.setVelocityX(500),s}return n}(i.a.GameObjects.Sprite),ht=function(e){it(o,e);var t,n,r,i=st(o);function o(e){var t;return rt(this,o),lt(ct(t=i.call(this,e.scene,e.x,e.y,"gun",0)),"props",void 0),lt(ct(t),"lastShootTime",Date.now()),lt(ct(t),"opened",!1),t.props=e,t.createAnimation(),t.init(),t.play("gun-idle"),t}return t=o,(n=[{key:"createAnimation",value:function(){this.scene.anims.create({key:"gun-idle",frames:this.scene.anims.generateFrameNumbers("gun",{start:0,end:2}),frameRate:4,repeat:-1})}},{key:"init",value:function(){this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0)}},{key:"shoot",value:function(){var e=this,t=Date.now();if(!(t-this.lastShootTime<500)){var n=new ft(this.scene,this.props.dir,this.x,this.y);this.props.group.add(n),this.setPipeline("blink"),setTimeout((function(){return e.resetPipeline()}),50),this.lastShootTime=t,this.props.soundManager.gun()}}}])&&nt(t.prototype,n),r&&nt(t,r),o}(i.a.GameObjects.Sprite);function pt(e){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dt(e,t){return(dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=gt(e);if(t){var i=gt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return bt(this,n)}}function bt(e,t){return!t||"object"!==pt(t)&&"function"!=typeof t?vt(e):t}function vt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gt(e){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ot=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dt(e,t)}(o,e);var t,n,r,i=mt(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),wt(vt(t=i.call(this,e.scene,e.x,e.y,"reflector",0)),"props",void 0),wt(vt(t),"lastSwitchTime",Date.now()),wt(vt(t),"lastCollisionTime",Date.now()),wt(vt(t),"opened",!1),t.props=e,t.init(),t}return t=o,(n=[{key:"init",value:function(){this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0)}},{key:"collide",value:function(){var e=this;this.setFrame(1),setTimeout((function(){e.setFrame(0)}),100),this.props.soundManager.reflectorCollide()}},{key:"switch",value:function(){var e,t,n=this,r=Date.now();if(!(r-this.lastSwitchTime<500)){null===(e=(t=this.props).onSwitch)||void 0===e||e.call(t);var i=360===this.angle?0:this.angle+90;this.scene.tweens.add({targets:this,angle:i,ease:"Linear",duration:200}),this.setPipeline("blink"),setTimeout((function(){return n.resetPipeline()}),50),this.lastSwitchTime=r,this.props.soundManager.reflector()}}}])&&yt(t.prototype,n),r&&yt(t,r),o}(i.a.GameObjects.Sprite);function St(e){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kt(e,t){return(kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Et(e);if(t){var i=Et(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return xt(this,n)}}function xt(e,t){return!t||"object"!==St(t)&&"function"!=typeof t?_t(e):t}function _t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Et(e){return(Et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kt(e,t)}(o,e);var t,n,r,i=jt(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Tt(_t(e=i.call(this,"L2")),"player",void 0),Tt(_t(e),"soundManager",void 0),Tt(_t(e),"isPlayerDisabled",void 0),Tt(_t(e),"tilemap",void 0),Tt(_t(e),"obstacles",void 0),Tt(_t(e),"spikes",void 0),Tt(_t(e),"bullets",void 0),Tt(_t(e),"reflectors",void 0),Tt(_t(e),"sphere",void 0),Tt(_t(e),"jumper",void 0),Tt(_t(e),"lever",void 0),Tt(_t(e),"gun",void 0),Tt(_t(e),"nextLevel",(function(){e.isPlayerDisabled=!0;var t=e.cameras.main;t.zoomTo(2,1e3),e.player.freeze(),e.soundManager.stopBGMusic(),e.soundManager.sphere(),t.once("camerazoomcomplete",(function(){t.fade(1e3,29,33,45)})),t.once("camerafadeoutcomplete",(function(){var t=e.soundManager.volumeConfig;e.player.destroy(),e.scene.start("L3",{volumeConfig:t})}))})),e}return t=o,(n=[{key:"create",value:function(e){var t=e.volumeConfig;this.soundManager=new Ie({volumeConfig:t,manager:this.sound}),this.isPlayerDisabled=!1,this.tilemap=this.make.tilemap({key:"mapL2"});var n=this.tilemap.addTilesetImage("industrial.v2","tiles");this.tilemap.createDynamicLayer("background",n),this.obstacles=this.tilemap.createDynamicLayer("obstacles",n),this.tilemap.createDynamicLayer("foreground",n).setDepth(10),this.createUI(),this.createSpikes(),this.createPlayer(),this.createGun(),this.createReflectors(),this.createLever(),this.createJumper(),this.createSphere(),this.obstacles.setCollisionByProperty({collides:!0}),this.physics.world.addCollider(this.player.sprite,this.obstacles),this.physics.world.addCollider(this.bullets,this.obstacles,(function(e){e.destroy()})),this.cameras.main.startFollow(this.player.sprite,!0,.1,.1),this.cameras.main.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels),this.soundManager.playBGMusic()}},{key:"getPoint",value:function(e,t){return this.tilemap.findObject(e,(function(e){return e.name===t}))}},{key:"getPoints",value:function(e,t){var n=this;return t.map((function(t){return n.getPoint(e,t)}))}},{key:"createUI",value:function(){var e=this,t=this.soundManager,n=t.bgMusicMuted,r=t.sfxMuted;new C({scene:this,texture:"button_music",x:this.cameras.main.width-32,y:32,switchedOn:!n,onSwitchOn:function(){e.soundManager.unmuteBGMusic()},onSwitchOff:function(){e.soundManager.muteBGMusic()}}),new C({scene:this,texture:"button_sfx",x:this.cameras.main.width-32,y:74,switchedOn:!r,onSwitchOn:function(){e.soundManager.unmuteSFX()},onSwitchOff:function(){e.soundManager.muteSFX()}})}},{key:"createSpikes",value:function(){var e=this;this.spikes=this.physics.add.staticGroup(),this.obstacles.forEachTile((function(t){if(77===t.index){var n=e.spikes.create(t.getCenterX(),t.getCenterY(),"spike");n.rotation=t.rotation,0===n.angle?n.body.setSize(32,6).setOffset(0,26):-90===n.angle?n.body.setSize(6,32).setOffset(26,0):90===n.angle?n.body.setSize(6,32).setOffset(0,0):-180===n.angle&&n.body.setSize(32,6).setOffset(0,0),e.obstacles.removeTileAt(t.x,t.y)}}))}},{key:"createPlayer",value:function(){var e=this.getPoint("points","spawn"),t=e.x,n=e.y;this.player=new oe({scene:this,x:t,y:n,soundManager:this.soundManager})}},{key:"createGun",value:function(){this.bullets=this.add.group();var e=this.getPoint("points","gun"),t=e.x,n=e.y;this.gun=new ht({scene:this,x:t,y:n,group:this.bullets,dir:"right",soundManager:this.soundManager})}},{key:"createReflectors",value:function(){var e=this;this.reflectors=this.physics.add.group({allowGravity:!1}),this.getPoints("points",["reflector_top","reflector_bottom"]).forEach((function(t){var n=t.x,r=t.y;return e.reflectors.add(new Ot({scene:e,x:n,y:r,soundManager:e.soundManager}))}))}},{key:"createLever",value:function(){var e=this,t=this.getPoint("points","lever"),n=t.x,r=t.y,i=this.getPoint("points","removable");this.lever=new Se({scene:this,x:n,y:r,soundManager:this.soundManager,onSwitchOn:function(){e.obstacles.removeTileAtWorldXY(i.x,i.y)},onSwitchOff:function(){e.obstacles.putTileAtWorldXY(14,i.x,i.y).setCollision(!0)}})}},{key:"createJumper",value:function(){var e=this.getPoint("points","jumper"),t=e.x,n=e.y;this.jumper=new et({scene:this,x:t,y:n,tile:this.obstacles.getTileAtWorldXY(t,n),soundManager:this.soundManager})}},{key:"createSphere",value:function(){var e=this.getPoint("points","sphere"),t=e.x,n=e.y;this.sphere=new pe({scene:this,x:t,y:n,onEnter:this.nextLevel})}},{key:"checkGunOverlap",value:function(){this.physics.world.overlap(this.gun,this.player.flash,(function(e){e.shoot()}))}},{key:"checkReflectorsOverlap",value:function(){this.physics.world.overlap(this.reflectors,this.player.flash,(function(e,t){t.switch()}))}},{key:"checkBulletReflectorOverlap",value:function(){this.physics.world.overlap(this.bullets,this.reflectors,(function(e,t){var n=Date.now(),r=e,i=t;if(!(n<i.lastCollisionTime+100)){var o=i.angle;switch(r.dir){case"right":if(![-90,-180].includes(o)){e.destroy();break}r.dir=-180===o?"down":"up",r.x=i.x-r.width/2,r.body.setVelocity(0,-180===o?500:-500),i.collide();break;case"left":if(![0,90].includes(o)){r.destroy();break}r.dir=90===o?"down":"up",r.x=i.x+r.width/2,r.body.setVelocity(0,90===o?500:-500),i.collide();break;case"up":if(![90,-180].includes(o)){r.destroy();break}r.dir=-180===o?"left":"right",r.x=i.x,r.y=i.y+r.height/2,r.body.setVelocity(-180===o?-500:500,0),i.collide();break;case"down":if(![0,-90].includes(o)){r.destroy();break}r.dir=-90===o?"left":"right",r.x=i.x,r.y=i.y-r.height/2,r.body.setVelocity(-90===o?-500:500,0),i.collide();break;default:r.destroy()}i.lastCollisionTime=n}}))}},{key:"checkLeversOverlap",value:function(){this.physics.world.overlap(this.lever,this.bullets,(function(e){e.switch()}))}},{key:"checkJumpersOverlap",value:function(){this.physics.world.overlap(this.jumper,this.player.sprite,(function(e,t){e.switch(),t.setVelocityY(-1e3)}))}},{key:"checkSphereOverlap",value:function(){this.physics.world.overlap(this.sphere,this.player.sprite,(function(e){e.activate()}))}},{key:"checkGameOver",value:function(){return this.physics.world.overlap(this.player.sprite,this.spikes)}},{key:"restart",value:function(){var e=this;this.isPlayerDisabled=!0;var t=this.cameras.main;t.shake(100,.05),t.fade(250,0,0,0),this.player.freeze(),this.soundManager.stopBGMusic(),this.soundManager.die(),t.once("camerafadeoutcomplete",(function(){e.player.destroy(),e.scene.restart()}))}},{key:"update",value:function(){this.isPlayerDisabled||(this.player.update(),this.checkGunOverlap(),this.checkReflectorsOverlap(),this.checkBulletReflectorOverlap(),this.checkLeversOverlap(),this.checkJumpersOverlap(),this.checkSphereOverlap(),this.checkGameOver()&&this.restart())}}])&&Pt(t.prototype,n),r&&Pt(t,r),o}(i.a.Scene);function Rt(e){return(Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ct(e,t){return(Ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function It(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lt(e);if(t){var i=Lt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return At(this,n)}}function At(e,t){return!t||"object"!==Rt(t)&&"function"!=typeof t?Gt(e):t}function Gt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lt(e){return(Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ct(e,t)}(o,e);var t,n,r,i=It(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Nt(Gt(t=i.call(this,e.scene,e.x,e.y,"bat",0)),"props",void 0),Nt(Gt(t),"hazardType","common"),t.props=e,t.createAnimations(),t.init(),t}return t=o,(n=[{key:"createAnimations",value:function(){var e=this.scene.anims;e.create({key:"bat-fly",frames:e.generateFrameNumbers("bat",{start:0,end:4}),frameRate:8,repeat:-1})}},{key:"init",value:function(){this.setScale(1.5),this.scene.add.existing(this),this.scene.physics.add.existing(this),this.body.enable=!0,this.body.setMaxVelocity(0,0),this.play("bat-fly")}},{key:"follow",value:function(){var e=this,t=this.props,n=t.start,r=t.end,i=t.followDuration,o=void 0===i?2e3:i,s=r.x<n.x;this.setFlipX(s),this.scene.tweens.add({targets:this,x:r.x,y:r.y,ease:"Sine",duration:o,onComplete:function(){e.setFlipX(!s),e.scene.tweens.add({targets:e,x:n.x,y:n.y,ease:"Sine",duration:o,onComplete:function(){e.follow()}})}})}},{key:"die",value:function(){this.anims.stop(),this.body.setMaxVelocity(0,1e3),this.body.setVelocityY(300)}}])&&Dt(t.prototype,n),r&&Dt(t,r),o}(i.a.GameObjects.Sprite);function Ft(e){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ht(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ut(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xt(e,t){return(Xt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Jt(e);if(t){var i=Jt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Kt(this,n)}}function Kt(e,t){return!t||"object"!==Ft(t)&&"function"!=typeof t?Wt(e):t}function Wt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jt(e){return(Jt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $t=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xt(e,t)}(o,e);var t,n,r,i=Vt(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Yt(Wt(e=i.call(this,"L3")),"timer",void 0),Yt(Wt(e),"soundManager",void 0),Yt(Wt(e),"player",void 0),Yt(Wt(e),"isPlayerDisabled",void 0),Yt(Wt(e),"tilemap",void 0),Yt(Wt(e),"obstacles",void 0),Yt(Wt(e),"spikes",void 0),Yt(Wt(e),"jumpers",void 0),Yt(Wt(e),"hazards",void 0),Yt(Wt(e),"platforms",[]),Yt(Wt(e),"sphere",void 0),Yt(Wt(e),"jumper",void 0),Yt(Wt(e),"lever",void 0),Yt(Wt(e),"nextLevel",(function(){e.isPlayerDisabled=!0;var t=e.cameras.main;t.zoomTo(2,1e3),e.player.freeze(),e.timer.remove(),e.platforms=[],e.soundManager.stopBGMusic(),e.soundManager.sphere(),t.once("camerazoomcomplete",(function(){t.fade(1e3,29,33,45)})),t.once("camerafadeoutcomplete",(function(){e.player.destroy(),e.scene.restart()}))})),e}return t=o,(n=[{key:"create",value:function(e){var t=this,n=e.volumeConfig;this.soundManager=new Ie({volumeConfig:n,manager:this.sound}),this.isPlayerDisabled=!1,this.tilemap=this.make.tilemap({key:"mapL3"});var r=this.tilemap.addTilesetImage("industrial.v2","tiles");this.tilemap.createDynamicLayer("background",r),this.obstacles=this.tilemap.createDynamicLayer("obstacles",r),this.tilemap.createDynamicLayer("foreground",r).setDepth(10),this.createUI(),this.createSpikes(),this.createPlayer(),this.createHidingPlatform(),this.createJumpers(),this.createHazards(),this.createSphere(),this.obstacles.setCollisionByProperty({collides:!0}),this.physics.world.addCollider(this.player.sprite,this.obstacles),this.cameras.main.startFollow(this.player.sprite,!0,.1,.1),this.cameras.main.setBounds(0,0,this.tilemap.widthInPixels,this.tilemap.heightInPixels),setTimeout((function(){t.timer=t.time.addEvent({delay:3e3,callback:function(){t.platforms.forEach((function(e,t){setTimeout((function(){null==e||e.switch()}),100*t)}))},callbackScope:t,loop:!0})}),100),this.soundManager.playBGMusic()}},{key:"getPoint",value:function(e,t){return this.tilemap.findObject(e,(function(e){return e.name===t}))}},{key:"getPoints",value:function(e,t){var n=this;return t.map((function(t){return n.getPoint(e,t)}))}},{key:"createUI",value:function(){var e=this,t=this.soundManager,n=t.bgMusicMuted,r=t.sfxMuted;new C({scene:this,texture:"button_music",x:this.cameras.main.width-32,y:32,switchedOn:!n,onSwitchOn:function(){e.soundManager.unmuteBGMusic()},onSwitchOff:function(){e.soundManager.muteBGMusic()}}),new C({scene:this,texture:"button_sfx",x:this.cameras.main.width-32,y:74,switchedOn:!r,onSwitchOn:function(){e.soundManager.unmuteSFX()},onSwitchOff:function(){e.soundManager.muteSFX()}})}},{key:"createSpikes",value:function(){var e=this;this.spikes=this.physics.add.staticGroup(),this.obstacles.forEachTile((function(t){if(77===t.index){var n=e.spikes.create(t.getCenterX(),t.getCenterY(),"spike");n.rotation=t.rotation,0===n.angle?n.body.setSize(32,6).setOffset(0,26):-90===n.angle?n.body.setSize(6,32).setOffset(26,0):90===n.angle?n.body.setSize(6,32).setOffset(0,0):-180===n.angle&&n.body.setSize(32,6).setOffset(0,0),e.obstacles.removeTileAt(t.x,t.y)}}))}},{key:"createPlayer",value:function(){var e=this.getPoint("points","spawn"),t=e.x,n=e.y;this.player=new oe({scene:this,x:t,y:n,soundManager:this.soundManager})}},{key:"createHidingPlatform",value:function(){var e=this;this.getPoints("platforms",["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"]).forEach((function(t){var n=t.x,r=t.y,i=new Re({scene:e,x:n,y:r,tilemap:e.obstacles});e.platforms.push(i)}))}},{key:"createJumpers",value:function(){var e=this;this.jumpers=this.physics.add.group({allowGravity:!1}),this.getPoints("points",["jumper1","jumper2","jumper3","jumper4"]).forEach((function(t,n){var r=t.x,i=t.y,o=new et({scene:e,x:r,y:i,tile:e.obstacles.getTileAtWorldXY(r,i),id:"jumper_".concat(n+1),soundManager:e.soundManager});e.jumpers.add(o)}))}},{key:"createHazards",value:function(){this.hazards=this.physics.add.group({allowGravity:!1});var e=Ht(this.getPoints("points",["h1_start","h1_end"]),2),t=e[0],n=e[1],r=new Bt({scene:this,x:t.x,y:t.y,start:t,end:n});r.follow(),this.hazards.add(r);var i=Ht(this.getPoints("points",["h2_start","h2_end"]),2),o=i[0],s=i[1],a=new Bt({scene:this,x:o.x,y:o.y,start:o,end:s});a.follow(),this.hazards.add(a)}},{key:"createSphere",value:function(){var e=this.getPoint("points","sphere"),t=e.x,n=e.y;this.sphere=new pe({scene:this,x:t,y:n,onEnter:this.nextLevel})}},{key:"checkJumpersOverlap",value:function(){this.physics.world.overlap(this.jumpers,this.player.sprite,(function(e,t){var n=t,r=e;switch(n.switch(),r.setVelocityY(-650),n.id){case"jumper_1":n.switch(),r.setVelocityY(-650);break;default:n.switch(),r.setVelocityY(-550)}}))}},{key:"checkSphereOverlap",value:function(){this.physics.world.overlap(this.sphere,this.player.sprite,(function(e){e.activate()}))}},{key:"checkGameOver",value:function(){return this.physics.world.overlap(this.player.sprite,this.spikes)||this.physics.world.overlap(this.player.sprite,this.hazards)}},{key:"restart",value:function(){var e=this;this.isPlayerDisabled=!0;var t=this.cameras.main;t.shake(100,.05),t.fade(250,0,0,0),this.player.freeze(),this.timer.remove(),this.platforms=[],this.soundManager.stopBGMusic(),this.soundManager.die(),t.once("camerafadeoutcomplete",(function(){e.player.destroy(),e.scene.restart()}))}},{key:"update",value:function(){this.isPlayerDisabled||(this.player.update(),this.checkJumpersOverlap(),this.checkSphereOverlap(),this.checkGameOver()&&this.restart())}}])&&zt(t.prototype,n),r&&zt(t,r),o}(i.a.Scene);function qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qt(Object(n),!0).forEach((function(t){Zt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(1757);var en,tn=(en=[P,Ve,Mt,$t],Qt(Qt({},{width:736,height:416}),{},{scene:en,type:i.a.AUTO,scale:{mode:i.a.Scale.FIT,autoCenter:i.a.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{debug:!1,gravity:{y:1e3}}},parent:document.getElementById("app"),backgroundColor:"#1d212d",pixelArt:!0,callbacks:{preBoot:function(e){e.device.input.touch&&document.body.classList.add("touch")}}}));new i.a.Game(tn)},669:function(e,t,n){n(670),e.exports=n(1758)}});